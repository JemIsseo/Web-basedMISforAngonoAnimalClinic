"use strict";(self.webpackChunk_msnews_msnews_experiences=self.webpackChunk_msnews_msnews_experiences||[]).push([["conditionalBannerWC"],{18862:function(e,n,t){t.r(n),t.d(n,{ConditionalBannerContentTemplate:function(){return S},ConditionalBannerWC:function(){return C},ConditionalBannerWCStyles:function(){return V},ConditionalBannerWCTemplate:function(){return _},ToolingInfo:function(){return z},cancelButtonContainer:function(){return T},confirmButtonContainer:function(){return P},dismissButtonContainer:function(){return x},imageContainer:function(){return v},textContainer:function(){return w}});var i=t(33940),a=t(85068),o=t(96324),r=t(4737),s=t(53076),l=t(83227),c=t(38156),d=t(65135),u=t(60483),h=t(64193),m=t(33379),p=t(7124),f=t(99452),g=t(82423);class C extends h.l{constructor(){super(...arguments),this.surfaceType=a.US.HorizontalBanner,this.supportedContentTypes=[a.JK.CallToAction],this.addConditionalBannerToPage=!1,this.isConditionalBannerVisible=!1,this.conditionalBannerQueue=[],this.debounceOnResize=(0,p.Z)(this.updateBannerVisibility).bind(this),this.prepareButtonTelemetry=()=>{this.containerTelemetry=new u.D({name:`${this.conditionalBannerId}_ConditionalBannerContainer`,behavior:c.wu.Show,action:c.Aw.View,content:{headline:"ConditionalBannerContainer"}}),this.confirmButtonTelemetry=new u.D({name:`${this.conditionalBannerId}_ConditionalBannerConfirmButton`,behavior:c.wu.Close,action:c.Aw.Click,content:{headline:"ConditionalBannerConfirmButton"}}),this.cancelButtonTelemetry=new u.D({name:`${this.conditionalBannerId}_ConditionalBannerCancelButton`,behavior:c.wu.Close,action:c.Aw.Click,content:{headline:"ConditionalBannerCancelButton"}}),this.dismissButtonTelemetry=new u.D({name:`${this.conditionalBannerId}_ConditionalBannerDismissButton`,behavior:c.wu.Close,action:c.Aw.Click,content:{headline:"ConditionalBannerDismissButton"}})},this.imageVisualReadinessCallback=()=>{this.markVisuallyReady()}}addConditionalBannerToPageChanged(){this.updateBannerVisibility()}experienceConnected(){var e;return(0,i.mG)(this,void 0,void 0,(function*(){this.conditionalBannerDataConnector=yield(0,g.K0)(s.z.ConditionalBannerData),null===(e=(0,o.Un)())||void 0===e||e.registerSurface(this,this.onPlacementReceived.bind(this)),this.imageVisualReadinessCallback(),(0,m.N)()&&(this.updateBannerVisibility(),window.addEventListener("resize",this.debounceOnResize))}))}disconnectedCallback(){removeEventListener("resize",this.debounceOnResize)}getExperienceType(){return l.x.conditionalBannerWC}onPlacementReceived(e){this.conditionalBannerQueue.push(e),this.showConditionalBanner()}showConditionalBanner(){var e,n;if(this.addConditionalBannerToPage||this.conditionalBannerQueue.length<=0)return;const t=this.conditionalBannerQueue.shift(),i=t.surfaceModel,a=t.contentModel;this.conditionalBannerId=t.id,this.leadText=a.description,this.imageUrl=(null===(e=a.logoImage)||void 0===e?void 0:e.url)||"http://img-s-msn-com.akamaized.net/tenant/amp/entityid/AA12keQu.img",this.altText=(null===(n=a.logoImage)||void 0===n?void 0:n.altText)||"",this.confirmButtonLabel=a.engageContentAction.label,this.cancelButtonLabel=a.dismissContentAction.label,this.dismissAfterSeconds=i.dismissAfterSeconds,this.displaySurfaceActionCallBack=i.displaySurfaceAction.actionDelegate,this.hideSurfaceActionCallBack=i.hideSurfaceAction.actionDelegate,this.engageContentActionCallBack=a.engageContentAction.actionDelegate,this.cancelContentActionCallBack=a.dismissContentAction.actionDelegate,this.dismissContentActionCallBack=a.closeContentAction.actionDelegate,this.prepareButtonTelemetry(),this.addConditionalBannerToPage=!0,this.addTmplOfBannerShownOrNot(),this.displaySurfaceActionCallBack(),!this.config.isInternal&&this.dismissAfterSeconds&&setTimeout(this.removeConditionalBanner.bind(this),1e3*this.dismissAfterSeconds)}removeConditionalBanner(){this.addConditionalBannerToPage&&(this.addConditionalBannerToPage=!1,this.addTmplOfBannerShownOrNot(),this.hideSurfaceActionCallBack()),this.showConditionalBanner()}handleDismissClick(){this.dismissContentActionCallBack(),this.removeConditionalBanner()}handleCancelClick(){this.cancelContentActionCallBack(),this.removeConditionalBanner()}handleConfirmButtonClick(){this.confirmButtonUrl&&window.open(this.confirmButtonUrl,"_blank"),this.engageContentActionCallBack(),this.removeConditionalBanner()}addTmplOfBannerShownOrNot(){const{addConditionalBannerToPage:e,conditionalBannerId:n}=this;d.M0.addOrUpdateTmplProperty(`conditionalBanner_${n}`,e?"1":"0")}updateBannerVisibility(){var e;this.addConditionalBannerToPage?this.isConditionalBannerVisible=window&&window.innerWidth>650:this.isConditionalBannerVisible=!1,null===(e=r.s.updateBannerDisplayState.getActionSender(this.conditionalBannerDataConnector))||void 0===e||e.send(this.isConditionalBannerVisible)}}(0,i.gn)([f.LO],C.prototype,"addConditionalBannerToPage",void 0),(0,i.gn)([f.LO],C.prototype,"isConditionalBannerVisible",void 0),(0,i.gn)([f.LO],C.prototype,"altText",void 0),(0,i.gn)([f.LO],C.prototype,"imageUrl",void 0),(0,i.gn)([f.LO],C.prototype,"confirmButtonLabel",void 0),(0,i.gn)([f.LO],C.prototype,"confirmButtonUrl",void 0),(0,i.gn)([f.LO],C.prototype,"cancelButtonLabel",void 0),(0,i.gn)([f.LO],C.prototype,"leadText",void 0),(0,i.gn)([f.LO],C.prototype,"conditionalBannerId",void 0),(0,i.gn)([f.LO],C.prototype,"containerTelemetry",void 0),(0,i.gn)([f.LO],C.prototype,"confirmButtonTelemetry",void 0),(0,i.gn)([f.LO],C.prototype,"cancelButtonTelemetry",void 0),(0,i.gn)([f.LO],C.prototype,"dismissButtonTelemetry",void 0),(0,i.gn)([f.LO],C.prototype,"dismissAfterSeconds",void 0),(0,i.gn)([f.LO],C.prototype,"conditionalBannerQueue",void 0);var y=t(49218),B=t(93703),b=t(545);const v=y.dy`<img alt="${e=>e.altText}" src="${e=>e.imageUrl}" class="leadImg" @load="${e=>e.imageVisualReadinessCallback()}" @error="${e=>e.imageVisualReadinessCallback()}"/>`,w=y.dy`<div class="leadText">${e=>e.leadText}</div>`,P=y.dy`<fluent-button role="button" tabindex="0" title=${e=>e.confirmButtonLabel} appearance="accent" class="banner-button" data-t="${e=>e.confirmButtonTelemetry.getMetadataTag()}" @click=${(e,n)=>e.handleConfirmButtonClick()}>${e=>e.confirmButtonLabel}</fluent-button>`,T=y.dy`<fluent-button role="button" tabindex="0" title=${e=>e.cancelButtonLabel} appearance="neutral" class="banner-button cancel-button" data-t="${e=>e.cancelButtonTelemetry.getMetadataTag()}" @click=${(e,n)=>e.handleCancelClick()}>${e=>e.cancelButtonLabel}</fluent-button>`,x=y.dy`<fluent-button class="dismiss-button" role="button" data-t="${e=>e.dismissButtonTelemetry.getMetadataTag()}" @click=${(e,n)=>e.handleDismissClick()}>${y.dy.partial(b.Z)}</fluent-button>`,S=y.dy`<div id="conditionalBanner" class="super-conditional-banner-container" style="${e=>e.isConditionalBannerVisible?"":"display: none"}" data-t="${e=>e.containerTelemetry.getMetadataTag()}">${e=>e.imageUrl&&v} ${w} ${e=>e.confirmButtonLabel&&P} ${e=>e.cancelButtonLabel&&T} ${x}</div>`,_=y.dy`
${(0,B.g)((e=>e.addConditionalBannerToPage),S)}
`;var k=t(42689),A=t(79148),R=t(80260),$=t(35680),O=t(22674),D=t(78923),L=t(29717);const I=D.i` .conditional-banner-image2{float:left}`,M=D.i` .conditional-banner-image2{float:right,}`,V=D.i`
.super-conditional-banner-container{display:flex;flex-direction:row;align-items:center;width:100%;height:48px;color:${k.C};background:#F7F7F7;box-shadow:0 -1px 5px grey;justify-content:flex-start;font-family:"Segoe UI",Arial,sans-serif;font-style:normal;font-weight:400}.leadImg{height:24px;width:24px;margin:0 13px 0 26px}.leadText{font-size:14px;line-height:20px;margin-right:12px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;min-width:196px;max-width:1020px;display:inline-block}.banner-button{border-radius:4px;border:none;align-items:center;height:32px;font-weight:600;font-size:14px;line-height:20px;margin:0 4px;overflow:hidden;min-width:fit-content}.cancel-button{border:1px solid #D1D1D1;background:${A.RJ}}.cancel-button:hover{background:${R.Qp}}.dismiss-button{height:20px;width:20px;min-width:20px;background:none;justify-content:center;align-items:center;border:none;cursor:pointer;border-radius:4px;margin-right:15px;margin-left:auto}.dismiss-button:hover{background:${$.Xi}}.dismiss-button svg{height:12px;width:12px}`.withBehaviors(new O.O(I,M),(0,L.Uu)(D.i` .super-conditional-banner-container{background:#404040}.cancel-button{border:1px solid #666666}`)),z={experienceConfigSchema:undefined}},4737:function(e,n,t){t.d(n,{s:function(){return a}});var i=t(55067);class a{}a.updateBannerDisplayState=new i.C("updateBannerDisplayState")},43297:function(e,n,t){t.r(n),t.d(n,{ConditionalBannerDataActions:function(){return i.s},ConditionalBannerDataConnector:function(){return o},ConditionalBannerDataReducer:function(){return s},ToolingInfo:function(){return l}});var i=t(4737),a=t(63439);class o extends a.e{constructor(e,n,t,i,a,o,r){super(e,n,t,i,a,o,r)}}var r=t(30856);class s{reduce(e,n){if(!e)return{isBannerDisplayed:!1};if(!n)return e;let t;return r.G.handleAction(n,i.s.updateBannerDisplayState,(n=>{t=Object.assign(Object.assign({},e),{isBannerDisplayed:n})})),t||e}}const l={experienceConfigSchema:{}}},96324:function(e,n,t){t.d(n,{Un:function(){return b},E0:function(){return C},c0:function(){return B}});var i,a,o,r=t(33940),s=t(65453),l=t(58155);!function(e){e.IrisCoachmark="iris-coachmark",e.IrisHorizontalBanner="iris-horizontal-banner",e.AmplifyCoachmark="amplify-coachmark",e.AmplifyHorizontalBanner="amplify-horizontal-banner"}(i||(i={})),function(e){e.LocalStore="local-store",e.PersistentStore="persistent-store"}(a||(a={})),function(e){e.Individual="individual",e.Group="group"}(o||(o={}));var c=t(59294);class d{constructor(e){this._priorityComparator=e,this._placementsArray=[]}enqueuePlacements(e){var n;e&&e.length&&(this._placementsArray.push(...e),this._priorityComparator&&this._placementsArray.sort(),null===(n=this._waitForPlacementSettablePromise)||void 0===n||n.set())}dequeuePlacement(){return(0,r.mG)(this,void 0,void 0,(function*(){this._placementsArray.length||(this._waitForPlacementSettablePromise=new c.o,yield this._waitForPlacementSettablePromise.getResultAsync());const e=this._placementsArray.shift();if(!e)throw new Error("Queue is empty but attempted to return a placement.");return e}))}}var u=t(26415);class h{constructor(){this._placementsSurfaceMap={}}addPlacements(e){e&&e.length&&e.forEach((e=>{const n=e.surfaceModel.surfaceType,t=this._placementsSurfaceMap[n];t?t.push(e):this._placementsSurfaceMap[n]=[e]}))}getPlacementsBySurface(e){const{surfaceType:n,supportedContentTypes:t}=e,i=this._placementsSurfaceMap[n];if(i&&i.length)return i.filter((e=>t.includes(e.contentModel.contentType)))}}class m{constructor(e,n=[]){this._surfacesRegisteredCallback=e,this._expectedSurfaces=n,this._surfaceRegistry={}}addSurface(e,n){e&&n&&(this.addSurfaceToRegistry(e,n),this._expectedSurfaces.length&&(this._expectedSurfaces=this._expectedSurfaces.filter((n=>n!==e.surfaceType)),this._expectedSurfaces.length)||this._surfacesRegisteredCallback([e]))}getSurfaceCallbackForPlacement(e){const n=e.surfaceModel.surfaceType,t=this._surfaceRegistry[n];if(!t)return;return t[e.contentModel.contentType]}addSurfaceToRegistry(e,n){const{surfaceType:t,supportedContentTypes:i}=e;i.forEach((e=>{const i=this._surfaceRegistry[t];i?i[e]=n:this._surfaceRegistry[t]={[e]:n}}))}}var p=t(65135),f=t(4734),g=t(32717);class C{constructor(e,n,t,i){this._placementProviders=e,this._interactionsTracker=n,this._rules=t,this._extensionContext=i,this._placementRegistry=new h,this._placementProcessingQueue=new d(null==i?void 0:i.priorityComparator),this._surfaceRegistry=new m(this.onSurfacesRegistered.bind(this),null==i?void 0:i.expectedSurfaces),this.initializeProviders(),Promise.all([(0,g.eC)(),(0,f.F_)()]).then(this.processPlacements.bind(this))}get Interactions(){return this._interactionsTracker.getPlacementsInteractions()}registerSurface(e,n){const{surfaceType:t,supportedContentTypes:i}=e||{};t&&i.length&&n?this._surfaceRegistry.addSurface(e,n):p.M0.sendAppErrorEvent(Object.assign(Object.assign({},u.hle.PlacementManagerError),{message:"Surface Type, Supported Content Types or Surface Callback are not provided."}))}initializeProviders(){return(0,r.mG)(this,void 0,void 0,(function*(){this._placementProviders.filter((e=>null==e?void 0:e.subscribeForPlacementStream)).forEach((e=>e.subscribeForPlacementStream((e=>this.onPlacementsReceived([e])))));const e=this._placementProviders.filter((e=>null==e?void 0:e.getAvailablePlacements)).map((e=>e.getAvailablePlacements())),n=(yield Promise.all(e)).flat();this.onPlacementsReceived(n)}))}onPlacementsReceived(e){var n,t;(null==e?void 0:e.length)&&(null===(t=null===(n=this._extensionContext)||void 0===n?void 0:n.onPlacementsReceived)||void 0===t||t.call(n,e),e.forEach((e=>{e.reportInteraction(s.p.Served)})),this._placementRegistry.addPlacements(e),this._placementProcessingQueue.enqueuePlacements(e.filter((e=>!!this._surfaceRegistry.getSurfaceCallbackForPlacement(e)))))}onSurfacesRegistered(e){const n=e.flatMap((e=>this._placementRegistry.getPlacementsBySurface(e)||[]));this._placementProcessingQueue.enqueuePlacements(n)}processPlacements(){return(0,r.mG)(this,void 0,void 0,(function*(){for(;;){const e=yield this._placementProcessingQueue.dequeuePlacement();(yield this.evaluatePlacement(e))&&(yield this.sendPlacementToSurface(e))}}))}evaluatePlacement(e){return(0,r.mG)(this,void 0,void 0,(function*(){const n=function(){const e=l.c.getQueryParameterByName("ignoreNurturingPlacementRules",window.location.search);return e?e.split(",").map((e=>e.trim())):[]}(),t=this._interactionsTracker.getPlacementsInteractions();if(!n.includes(o.Individual))for(const n of e.getPlacementRules()){if(!(yield n(e,t)))return!1}if(!n.includes(o.Group)){const n=this._rules[e.group]||[];for(const i of n){if(!(yield i(e,t)))return!1}}if("1"===l.c.getQueryParameterByName("vptest",window.location.search)){if(!function(){const e=l.c.getQueryParameterByName("filterNurturingPlacements",window.location.search);return e?e.split(",").map((e=>e.trim())):[]}().includes(e.id))return!1}return!0}))}sendPlacementToSurface(e){return(0,r.mG)(this,void 0,void 0,(function*(){const n=this._surfaceRegistry.getSurfaceCallbackForPlacement(e);if(!n)return void p.M0.sendAppErrorEvent(Object.assign(Object.assign({},u.hle.PlacementManagerError),{message:"Surface is not registered for this Content Type."}));const t=new c.o,i=new c.o,a=Promise.all([t.getResultAsync(),i.getResultAsync()]);e.onPlacementInteraction=n=>{var a,o;null===(o=null===(a=this._extensionContext)||void 0===a?void 0:a.onPlacementInteraction)||void 0===o||o.call(a,e,n),this._interactionsTracker.logPlacementInteraction(e.id,n),n===s.p.Viewed&&t.set(),n===s.p.Hidden&&i.set()},n(e);const o=e.surfaceModel.dismissAfterSeconds?1e3*e.surfaceModel.dismissAfterSeconds:0;o?yield Promise.race([a,new Promise((e=>setTimeout(e,o)))]):yield a}))}}let y;const B=e=>{y=e},b=()=>y}}]);