"use strict";(self.webpackChunk_msnews_msnews_experiences=self.webpackChunk_msnews_msnews_experiences||[]).push([["coachmark-wc"],{48811:function(e,t,a){a.r(t),a.d(t,{CoachmarkWC:function(){return ae},CoachmarkWCStyles:function(){return Te},CoachmarkWCTemplate:function(){return ge},ToolingInfo:function(){return Ee}});var i,o=a(33940),n=a(29993),r=a(6660),s=a(73231),c=a(12574);!function(e){e.closeButton="closeButton",e.ctaButton="ctaButton",e.ctaButtonTwo="ctaButtonTwo",e.coachmarkElement="coachmarkElement",e.coachmarkPointerElement="coachmarkPointerElement"}(i||(i={}));const h=13,d=26;var l=a(53076),m=a(83227),u=a(94537),g=a(59997),p=a(38156),k=a(65135),v=a(17769),f=a(73252),C=a(44979),y=a(88352),w=a(70694),b=a(66588),T=a(35357),E=a(71443),x=a(64193),B=a(76858),I=a(26415),L=a(33954),$=a(68364),P=a(92031),A=a(24888),D=a(61857),M=a(82209);const O=(e,t)=>{switch(e.ctaBehavior){case W.launchAndDefaultWebWidget:return()=>(0,o.mG)(void 0,void 0,void 0,(function*(){N(t.hideCoachmark);const e=(0,P.IV)(t.currentLayout);e&&e()}));case W.openAddDialog:return S(t);case W.openWaffleDialog:return()=>(0,o.mG)(void 0,void 0,void 0,(function*(){N(t.hideCoachmark);const e=(0,P.Zs)();e&&e()}));case W.pinMsnews:return()=>(0,o.mG)(void 0,void 0,void 0,(function*(){N(t.hideCoachmark);const e=(0,P.z2)();e&&e()}));case W.switchFeedToggleToContentVisible:return()=>(0,o.mG)(void 0,void 0,void 0,(function*(){N(t.hideCoachmark);const e=(0,P.Rc)();e&&e()}));case W.switchFeedToggleToContentPartiallyVisible:return()=>(0,o.mG)(void 0,void 0,void 0,(function*(){N(t.hideCoachmark);const e=(0,P.IK)();e&&e()}));case W.switchToOffice365Tab:return()=>(0,o.mG)(void 0,void 0,void 0,(function*(){N(t.hideCoachmark);const e=(0,P.U$)(P.QF.tryOffice365);e&&e();const a=(0,P.Rc)();a&&a()}));case W.tryInformationalMode:return()=>(0,o.mG)(void 0,void 0,void 0,(function*(){N(t.hideCoachmark);const e=(0,P.Kb)(t.delayInMs);e&&e()}));case W.tryInformationalModeProg:return()=>(0,o.mG)(void 0,void 0,void 0,(function*(){N(t.hideCoachmark);const e=(0,P.$S)(t.delayInMs);e&&e()}));case W.tryInformationalModeDirect:return()=>(0,o.mG)(void 0,void 0,void 0,(function*(){N(t.hideCoachmark);const e=(0,P.gA)();e&&e()}));case W.tryVoiceSearch:return()=>(0,o.mG)(void 0,void 0,void 0,(function*(){N(t.hideCoachmark);const e=(0,P.tV)();e&&e()}));case W.setDefaultBrowser:return()=>(0,o.mG)(void 0,void 0,void 0,(function*(){N(t.hideCoachmark);const e=(0,P.js)();e&&e(),t.edgeNurturingAPICampaignName&&M.M.updateCTA(t.edgeNurturingAPICampaignName,!0)}));case W.focusOnSearchBar:return()=>(0,o.mG)(void 0,void 0,void 0,(function*(){N(t.hideCoachmark);const e=(0,P.Gh)();e&&e()}));case W.openRewardsFlyout:return()=>(0,o.mG)(void 0,void 0,void 0,(function*(){N(t.hideCoachmark);const e=(0,P.U1)();e&&e()}));case W.closeFeed:return()=>(0,o.mG)(void 0,void 0,void 0,(function*(){N(t.hideCoachmark);const e=(0,P.eT)();e&&e()}));default:k.M0.sendAppErrorEvent(Object.assign(Object.assign({},I.WD2.InvalidCTAType),{message:"CTA type is invalid or not found.",pb:Object.assign(Object.assign({},I.WD2.InvalidCTAType.pb),{customMessage:`CTA type: ${e.ctaBehavior} is invalid `})}))}},S=e=>()=>(0,o.mG)(void 0,void 0,void 0,(function*(){N(e.hideCoachmark);const t=e.delayInMs||2e3;let a;const i=A.LR[A.HV.clickAddTileButton];i&&(a=yield i({})),L.k.log(`Action completed: ${a.actionCompleted} status: ${a.status}`),yield(0,D.rT)(t);const o=e.updateCoachmark;o&&o()}));function N(e){e&&e()}var W;!function(e){e.closeFeed="closeFeed",e.focusOnSearchBar="focusOnSearchBar",e.launchAndDefaultWebWidget="launchAndDefaultWebWidget",e.openAddDialog="openAddDialog",e.openRewardsFlyout="openRewardsFlyout",e.openWaffleDialog="openWaffleDialog",e.pinMsnews="pinMsnews",e.setDefaultBrowser="setDefaultBrowser",e.switchFeedToggleToContentPartiallyVisible="switchFeedToggleToContentPartiallyVisible",e.switchFeedToggleToContentVisible="switchFeedToggleToContentVisible",e.switchToOffice365Tab="switchToOffice365Tab",e.tryInformationalMode="tryInformationalMode",e.tryInformationalModeDirect="tryInformationalModeDirect",e.tryInformationalModeProg="tryInformationalModeProg",e.tryVoiceSearch="tryVoiceSearch"}(W||(W={}));var H=a(9533);function j(e){k.M0.sendAppErrorEvent(e)}function _(e){k.M0.addOrUpdateTmplString(e)}function R(e,t,a,i,o,n){k.M0.sendActionEvent(t,o,n,a)}function G(e,t,a,i,o,n){e&&a&&t&&R(0,a,i,0,o,n)}var U=a(90042),F=a(35618),K=a(59294),z=a(18536),V=a(60483),Q=a(99452),X=a(65932),J=a(42166),Y=a(82423),Z=a(32717),q=a(53146),ee=a(9500),te=a(55027);class ae extends x.l{constructor(){super(...arguments),this.currentLangDir=document.dir,this.currentPointerTopOffset=0,this.currentPointerLeftOffset=0,this.reRenderCoachmark=!1,this.pslSet=!1,this.windowClickEventCallback=e=>{if(this.coachmarkElement&&this.coachmarkElement&&this.coachmarkElement.getBoundingClientRect){const t=this.coachmarkElement.getBoundingClientRect();if(!(e.clientX&&e.clientY&&e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom)&&this.addCoachmarkToPage){if(!this.userInteractedWithCoachmark){if(this.currentCoachmarkName===F.xn&&e.composedPath){if(e.composedPath().some((e=>e.tagName&&"cs-personalized-feed"===e.tagName.toLowerCase())))return void _(`ClickedFeed_${this.currentCoachmarkName}:1`)}_(`ClickedAwayFromCoachmark_${this.currentCoachmarkName}:1`),G("click_nonnav",`ClickedAwayFromCoachmark_${this.currentCoachmarkName}`,this.coachmarkElement,"",p.Aw.Click,p.wu.Hide)}this.hideCoachmark(),this.currentCoachmarkName===F.xn&&window.scrollTo({top:0,behavior:"smooth"})}return e}},this.windowUpdateEventCallback=()=>{window.requestAnimationFrame((()=>{this.updateCoachmarkPosition(this.coachmarkPosition,!0),this.updatePointer(this.coachmarkPosition,this.pointerPosition),(0,q.oW)(this.currentCoachmarkName,innerHeight)&&this.hideCoachmark()}))},this.scrollEventCallback=(0,v.k)(this.windowUpdateEventCallback,0),this.coachmarkPlaced=(e,t,a)=>(0,o.mG)(this,void 0,void 0,(function*(){this.coachmarkDataConnector?(n.$.updateCoachmarkVisibleStatus.getActionSender(this.coachmarkDataConnector).send(!0),n.$.updateCoachmarkName.getActionSender(this.coachmarkDataConnector).send(this.name),n.$.updateCoachmarkHeight.getActionSender(this.coachmarkDataConnector).send(this.coachmarkHeight)):j(Object.assign(Object.assign({},I.WD2.CoachmarkDataConnectorUndefined),{message:`Error reporting coachmark: ${e} status due to undefined coachmark data connector.`,pb:Object.assign(Object.assign({},I.WD2.CoachmarkDataConnectorUndefined.pb),{customMessage:`coachmark: ${e} creativeId: ${t} positionId: ${a}`})}))})),this.closeButtonKeyDownHandler=e=>{if(e.key===u.oM&&this.ctaList)if(e.shiftKey){e.preventDefault();(this.ctaButtonTwoElement?this.ctaButtonTwoElement:this.ctaButtonElement).focus()}else e.preventDefault(),this.ctaButtonElement&&this.ctaButtonElement.focus();else e.key===u.kL&&this.closeCoachmark(e,r.M.Dismiss,p.Aw.Click,p.wu.Close,!1,!0)},this.closeCoachmark=(e,t,a,i,c,h)=>(0,o.mG)(this,void 0,void 0,(function*(){if(!c&&!e&&!e.currentTarget){const t=z.u.get(e.currentTarget);t.contract.overrideDestinationUrl=window&&window.location&&window.location.href,t.contract.behavior=i,G("click_nonnav","Dismiss",e.currentTarget,"ntp",a,i)}this.coachmarkSource!==s.jX.Experience&&this.reportEvent(r.R.Action,this.eventUrl,t,this.creativeId,this.positionId),this.edgeNurturingAPICampaignName&&M.M.updateCTA(this.edgeNurturingAPICampaignName,!1),this.removeCoachmarkFromPage(),this.cleanup(),this.coachmarkDataConnector&&(n.$.updateCoachmarkVisibleStatus.getActionSender(this.coachmarkDataConnector).send(!1),n.$.updateCoachmarkName.getActionSender(this.coachmarkDataConnector).send(void 0),n.$.updateCoachmarkHeight.getActionSender(this.coachmarkDataConnector).send(void 0))})),this.closeButtonHandler=()=>{this.currentCoachmarkName===F.xn&&window.scrollTo({top:0,behavior:"smooth"})},this.ctaButtonHandler=(e,t=0,a)=>{e.stopPropagation(),this.userInteractedWithCoachmark=!0,"click"==e.type&&(a=r.M.Click);const i={creativeId:this.creativeId,coachmarkSource:this.coachmarkSource,currentLayout:this.chromiumCurrentLayout,delayInMs:1e3,eventUrl:this.eventUrl,hideCoachmark:this.hideCoachmark.bind(this),irisAction:a,name:this.currentCoachmarkName?this.currentCoachmarkName:"COACHMARK",positionId:this.positionId,reportEvent:this.reportEvent.bind(this),trackEvent:R,updateCoachmark:this.updateCoachmark,edgeNurturingAPICampaignName:this.edgeNurturingAPICampaignName};k.M0.sendActionEvent(e.currentTarget),((e,t,a)=>{if(!t)return void k.M0.sendAppErrorEvent(Object.assign(Object.assign({},I.WD2.CoachmarkStateNotDefined),{message:"Coachmark state is not defined"}));const{ctaBehavior:i,ctaButtonURL:n}=e;return i?a?()=>(0,o.mG)(void 0,void 0,void 0,(function*(){t.coachmarkSource!==s.jX.Experience&&t.reportEvent(r.R.Action,t.eventUrl,t.irisAction,t.creativeId,t.positionId);const a=O(e,t);return a?yield a():null})):void k.M0.sendAppErrorEvent(Object.assign(Object.assign({},I.WD2.EventNotDefined),{message:"Event is not defined"})):n?void(t.coachmarkSource!==s.jX.Experience&&t.reportEvent(r.R.Action,t.eventUrl,t.irisAction,t.creativeId,t.positionId)):void k.M0.sendAppErrorEvent(Object.assign(Object.assign({},I.WD2.CTATypeNotDefined),{message:"CTA type is not defined"}))})(this.ctaList[t],i,e)()},this.keyDownHandler=e=>{e.key===u.CX&&this.closeCoachmark(e,r.M.Dismiss,p.Aw.Click,p.wu.Hide)},this.lastElementKeyDownHandler=e=>{e.key===u.oM?e.shiftKey?(e.preventDefault(),this.ctaButtonElement&&this.ctaButtonElement.focus()):(e.preventDefault(),this.closeButtonElement&&this.closeButtonElement.focus()):e.key===u.kL&&this.closeCoachmark(e,r.M.Dismiss,p.Aw.Click,p.wu.Hide,!0)}}get isModal(){return!(this.name&&this.config&&this.config.nonModalDialogs&&this.config.nonModalDialogs.length)||!this.config.nonModalDialogs.includes(this.name)}experienceConnected(){return(0,o.mG)(this,void 0,void 0,(function*(){this.coachmarkDataConnector=(0,Y.K0)(l.z.CoachmarkData);let e=null;(0,X.Uo)(l.z.ChromiumPageSettings,(e=>{this.chromiumPageSettingsState=e,this.chromiumCurrentLayout=e.currentLayout})),this.coachmarkDataConnector?((0,X.Uo)(l.z.CoachmarkData,(t=>(0,o.mG)(this,void 0,void 0,(function*(){if(t&&t.coachmarkMessages){if(e===t.coachmarkMessages)return;this.convertMessageFormat(t.coachmarkMessages),e=t.coachmarkMessages,yield this.showAndPositionCoachmarkWrap(t.coachmarkMessages)}})))),this.coachmarkDataConnector.getCoachmarks().then((e=>(0,o.mG)(this,void 0,void 0,(function*(){if(this.convertMessageFormat(e),e&&e.length&&e[0].name){if(!this.canCampaignShow(e[0].name))return;yield this.showAndPositionCoachmarkWrap(s.kE.extractMessages(e))}else this.markVisuallyReady()}))))):(this.markVisuallyReady(),j(Object.assign(Object.assign({},I.WD2.CoachmarkDataConnectorUndefined),{message:"Coachmark data connector is undefined"})))}))}canCampaignShow(e){const t={name:e};return ee.i.getInstance().register(t)}convertMessageFormat(e){!e||e.length<=0||e.forEach((e=>{"128000000003090209"===e.creativeId&&f.Al.CurrentFlights.indexOf("prg-leftrail")>-1&&(e.nonTargetPlacement=s.HJ.TopStart),e.coachmarkSource===s.jX.Iris&&e.ctaList&&e.ctaList.forEach((e=>{e.ctaButtonText=e.ctaText,e.ctaButtonURL=e.destinationurl;const t=e.ctaType;e.ctaType=e.ctaBehavior,e.ctaBehavior=t}))}))}getExperienceType(){return m.x.coachmarkWC}addAutoDismiss(){if(this.timeoutInMs>0){const e=this.currentMessageIndex;window.setTimeout((()=>{this.addCoachmarkToPage&&(this.addCoachmarkToPage=!this.addCoachmarkToPage,_(`CoachmarkAutoDismissed_${this.currentCoachmarkName}:1`),G("click_nonnav",`CoachmarkAutoDismissed_${this.currentCoachmarkName}`,this.coachmarkElement,"",p.Aw.Click,p.wu.Hide),this.timeoutTriggered(e))}),this.timeoutInMs)}}addCoachmarkMessages(e){var t;if(!e||!e.length)return;this.coachmarkMessageQueue?"object"==typeof this.coachmarkMessageQueue&&this.coachmarkMessageQueue.length&&(this.coachmarkMessageQueue.push(...e),(this.messageIndex<0||this.messageIndex>=this.coachmarkMessageQueue.length)&&(this.messageIndex=this.coachmarkMessageQueue.length-1)):(this.coachmarkMessageQueue=e,this.messageIndex=0);const a=this.coachmarkMessageQueue[this.messageIndex];this.currentCoachmarkName=a.name,this.targetElementKey=a.targetElement,this.creativeId=a.creativeId,this.positionId=a.positionId,this.actionPauseInMs=null!==(t=a.actionPauseInMs)&&void 0!==t?t:null}closeTelemetryTag(){return new V.D({name:"Dismiss",behavior:p.wu.Close,content:{headline:"Dismiss",type:p.uH.Coachmark}})}checkCoachmarkViewportFit(){if(!(window&&this.coachmarkElement&&this.coachmarkElement&&this.coachmarkElement.getBoundingClientRect))return window?"Coachmark element not found or not able to retrieve coachmark size and relative position to viewport":"Window object undefined";const e=this.coachmarkElement.getBoundingClientRect(),t=(0,C.Nd)((new C.fH).data.innerWidth,"innerWidth"),a=`top: ${e.top} bottom: ${e.bottom} left: ${e.left} right: ${e.right}`;return e.top<0?"Too Far Above. Exceeds Page Top. "+a:e.left<0?"Too Far Left. Exceeds Page Side. "+a:e.bottom>window.innerHeight||e.bottom>document.documentElement.clientHeight?"Too Far Below. Exceeds Page Bottom. "+a+` innnerHeight: ${window.innerHeight} clientHeight: ${document.documentElement.clientHeight}`:e.right>t||e.right>document.documentElement.clientWidth?"Too Far Right. Exceeds Page Side. "+a+` width: ${t} clientWidth: ${document.documentElement.clientWidth}`:null}cleanup(){this.targetElement=null,window.removeEventListener("resize",this.windowUpdateEventCallback),window.removeEventListener("scroll",this.scrollEventCallback),window.removeEventListener("click",this.windowClickEventCallback),te.I.headerTransitionEnd.unregisterObserver(this.windowUpdateEventCallback),this.coachmarkElement&&this.coachmarkElement.style&&(this.coachmarkElement.style.top="0",this.coachmarkElement.style.left="0")}findTargetElement(){const e=(0,H.b_)(this.targetElementKey);if(!this.floatingPosition)return e||j(Object.assign(Object.assign({},I.WD2.GeneralError),{message:`Error rendering ${this.currentCoachmarkName} coachmark due to absent target element: ${this.targetElement} on page.`,pb:Object.assign(Object.assign({},I.WD2.GeneralError.pb),{customMessage:`Coachmark: ${this.currentCoachmarkName} not rendered on user screen due to absent target element: ${this.targetElement} on page\n                            creativeId: ${this.creativeId} positionId: ${this.positionId}`})})),e}getCoachmarkElements(){this.closeButtonElement=this.shadowRoot.getElementById(i.closeButton),this.ctaButtonTwoElement=this.shadowRoot.getElementById(i.ctaButtonTwo),this.ctaButtonElement=this.shadowRoot.getElementById(i.ctaButton),this.coachmarkElement=this.shadowRoot.getElementById(i.coachmarkElement),this.coachmarkPointerElement=this.shadowRoot.getElementById(i.coachmarkPointerElement)}hideCoachmark(){this.addCoachmarkToPage=!1,this.coachmarkDataConnector&&(n.$.updateCoachmarkVisibleStatus.getActionSender(this.coachmarkDataConnector).send(!1),n.$.updateCoachmarkName.getActionSender(this.coachmarkDataConnector).send(void 0),n.$.updateCoachmarkHeight.getActionSender(this.coachmarkDataConnector).send(void 0))}initCoachmark(){return(0,o.mG)(this,void 0,void 0,(function*(){if(this.addCoachmarkToPage){if(this.targetElement=this.findTargetElement(),this.targetElement||"128000000002304969"==this.creativeId||"128000000002370389"==this.creativeId||this.floatingPosition){this.userInteractedWithCoachmark=!1,this.updateCoachmarkPosition(this.coachmarkPosition),this.showPointer&&this.updatePointer(this.coachmarkPosition,this.pointerPosition);const t=this.checkCoachmarkViewportFit();if(t)return j(Object.assign(Object.assign({},I.WD2.NotPlaceable),{message:`Coachmark: ${this.currentCoachmarkName} not placeable on user screen`,pb:Object.assign(Object.assign({},I.WD2.NotPlaceable.pb),{customMessage:`Error rendering coachmark: ${this.currentCoachmarkName} creativeId: ${this.creativeId} positionId: ${this.positionId}\n                        on user screen. ${t}`})})),void this.removeCoachmarkFromPage();if(addEventListener("scroll",this.scrollEventCallback,!1),addEventListener("resize",this.windowUpdateEventCallback,!1),addEventListener("click",this.windowClickEventCallback,!0),te.I.headerTransitionEnd.registerObserver(this.windowUpdateEventCallback),this.addAutoDismiss(),_(`userEligibleToSeeCoachmark_${this.currentCoachmarkName}:1`),y.b.isNotNullOrUndefined(this.renderCoachmark)&&!this.renderCoachmark)return _(`coachmarkSuppressed_${this.currentCoachmarkName}:1`),void this.removeCoachmarkFromPage();this.renderCoachmark&&_(`coachmarkShown_${this.currentCoachmarkName}:1`),this.coachmarkDataConnector.getCurrentState().coachmarkName!==this.currentCoachmarkName&&(e=this.coachmarkElement,k.M0&&e&&k.M0.observeElementTree(e)),this.coachmarkPlaced(this.currentCoachmarkName,this.creativeId,this.positionId),this.coachmarkSource!==s.jX.Experience||this.pslSet||(this.pslSet=!0,yield this.setLocalCoachmarkPSLPref()),this.coachmarkSource!==s.jX.Experience&&this.reportEvent(r.R.Impression,this.eventUrl,void 0,this.creativeId,this.positionId)}else this.removeCoachmarkFromPage(),this.targetElement=null;var e;this.markVisuallyReady()}else this.markVisuallyReady()}))}setLocalCoachmarkPSLPref(){return(0,o.mG)(this,void 0,void 0,(function*(){if(this.creativeNamespace){const e=w.p.isDhpPage()?"dhp":"ntp";yield U.S.setLocalCoachmarkCampaignByKeyAndName(this.creativeNamespace,this.name,e)}}))}isECSFeatureFlagsEnabled(e){var t,a;return(0,o.mG)(this,void 0,void 0,(function*(){if(this.configData||(this.configData=yield c.Vv.getConfigData()),!e||!this.configData)return!1;const i=e.split(",");for(const e in i)if(!this.configData[i[e]])return!1;if(i.find((e=>"canLaunchWebWidget"===e))&&(null===(a=null===(t=null===window||void 0===window?void 0:window.chrome)||void 0===t?void 0:t.desktopWidgetPrivate)||void 0===a?void 0:a.isWebWidgetAllowed)){const e=new K.o;return window.chrome.desktopWidgetPrivate.isWebWidgetAllowed((t=>{!0===t?e.set(!0):e.set(!1)})),e.getResultAsync()}return!0}))}populateTelemetryTags(e,t,a,i){return new V.D({name:i?i.replace(/\s/g,""):e.replace(/\s/g,""),behavior:t?p.wu[`${t}`]:a,content:{headline:e.replace(/\s/g,""),type:p.uH.Coachmark}})}removeCoachmarkFromPage(){this.coachmarkMessageQueue=null,this.messageIndex=-1,this.addCoachmarkToPage=!1,this.currentCoachmarkName=void 0}reportEvent(e,t,a,i,o){this.coachmarkDataConnector?this.coachmarkDataConnector.reportEvent(e,t,a,i,o):j(Object.assign(Object.assign({},I.WD2.CoachmarkDataConnectorUndefined),{message:"Error reporting iris telemetry due to undefined coachmark data connector.",pb:Object.assign(Object.assign({},I.WD2.CoachmarkDataConnectorUndefined.pb),{customMessage:`creativeId: ${i} positionId: ${o} irisAction: ${a} eventType: ${e} eventUrl: ${JSON.stringify(t)}`})}))}showAndPositionCoachmarkWrap(e){return(0,o.mG)(this,void 0,void 0,(function*(){(0,T.hI)()?window.addEventListener(E.C,(()=>{this.showAndPositionCoachmark(e)})):yield this.showAndPositionCoachmark(e)}))}showAndPositionCoachmark(e){return(0,o.mG)(this,void 0,void 0,(function*(){!e||e.length<=0||(this.removeCoachmarkFromPage(),this.addCoachmarkMessages(e),e[0].floatingPosition||(yield(0,Z.eC)().then((()=>(0,o.mG)(this,void 0,void 0,(function*(){const e=(0,H.h_)(this.targetElementKey),t=(0,b.rh)(1e4);if(!(yield Promise.race([e,t])))return j(Object.assign(Object.assign({},I.WD2.GeneralError),{message:`Waited for 10000ms. Target element with id ${this.targetElementKey} not found. Coachmark ${this.currentCoachmarkName} cannot be rendered on page.`,pb:Object.assign(Object.assign({},I.WD2.GeneralError.pb),{customMessage:`Waited for 10000ms. Target element with id ${this.targetElementKey} not found. Coachmark ${this.currentCoachmarkName} cannot be rendered on page. creativeId: ${this.creativeId} positionId: ${this.positionId}`})})),void this.removeCoachmarkFromPage();this.actionPauseInMs&&(yield(0,b.rh)(this.actionPauseInMs))}))))),yield this.updateCoachmarkProperty(),yield(0,B.y)(),this.getCoachmarkElements(),yield this.initCoachmark())}))}timeoutTriggered(e){e===this.messageIndex&&this.removeCoachmarkFromPage()}updateCoachmark(){this.messageIndex=this.messageIndex+1,this.addCoachmarkToPage=!0,this.currentCoachmarkName=this.coachmarkMessageQueue[this.messageIndex].name}updateCoachmarkPosition(e,t){let a=0,i=0;const o=document.documentElement.clientWidth,n=document.documentElement.clientHeight,r=this.currentLangDir===g.N.ltr;if(t&&(this.targetElement=this.findTargetElement()),this.targetElement&&this.targetElement.getBoundingClientRect&&this.coachmarkElement&&this.coachmarkElement.style){const t=this.targetElement.getBoundingClientRect(),n=this.coachmarkElement.getBoundingClientRect();if(0==t.height)return void this.hideCoachmark();const c=this.showPointer?20:7;switch(this.coachmarkHeight=n.height,e){case s.ur.Above:a=t.top-n.height-c,i=t.left+t.width/2-n.width/2;break;case s.ur.Below:a=t.bottom+c,i=t.left+t.width/2-n.width/2;break;case s.ur.Right:a=t.top+t.height/2-n.height/2,i=r?t.right+c:o-t.left+c;break;case s.ur.Left:a=t.top+t.height/2-n.height/2,i=r?t.left-n.width-c:o-t.right-n.width-c;break;default:return void j(Object.assign(Object.assign({},I.WD2.GeneralError),{message:`Error rendering ${this.currentCoachmarkName} coachmark pointer due to invalid pointer position value`,pb:Object.assign(Object.assign({},I.WD2.GeneralError.pb),{customMessage:`Invalid pointer position value for coachmark: ${this.currentCoachmarkName} creativeId: ${this.creativeId} positionId: ${this.positionId}`})}))}}if(this.coachmarkElement&&this.floatingPosition){const e=this.coachmarkElement.getBoundingClientRect(),t=10;switch(this.floatingPosition){case s.HJ.TopStart:case s.HJ.BottomStart:i=t;break;case s.HJ.TopEnd:case s.HJ.BottomEnd:i=o-e.width-t;break;default:i=t}switch(this.floatingPosition){case s.HJ.TopStart:case s.HJ.TopEnd:a=t;break;case s.HJ.BottomStart:case s.HJ.BottomEnd:a=n-e.height-t;break;default:a=t}}this.coachmarkElement&&(this.coachmarkElement.style.top=a?(0,J.a)(a):"auto",r?this.coachmarkElement.style.left=i?(0,J.a)(i):"auto":this.coachmarkElement.style.right=i?(0,J.a)(i):"auto")}updateCoachmarkProperty(){var e;return(0,o.mG)(this,void 0,void 0,(function*(){let t=null;this.coachmarkMessageQueue&&this.messageIndex>=0&&this.coachmarkMessageQueue[this.messageIndex]&&(t=this.coachmarkMessageQueue[this.messageIndex]),this.currentMessageIndex=this.messageIndex,this.eventUrl=t&&t.eventUrl?t.eventUrl:void 0,this.currentCoachmarkName=this.currentCoachmarkName?this.currentCoachmarkName.replace(/\s/g,""):"coachmark_module_v2";const a=yield this.isECSFeatureFlagsEnabled(t.ecsFeatureFlags);this.renderCoachmark=t&&t.isEcsExperiment?a:this.config.renderCoachmark,this.renderCoachmark&&(this.body=t.body?t.body:null,this.closeText=t.cancelText?t.cancelText:null===(e=this.strings)||void 0===e?void 0:e.dismiss,this.coachmarkPosition=t.coachmarkPosition,this.coachmarkSize=t.coachmarkSize,this.coachmarkWidth=function(e){switch(s.dm[e]){case s.dm.Small:return"280px";case s.dm.Medium:return"320px";case s.dm.Large:return"400px";default:return"280px"}}(t.coachmarkSize),this.coachmarkButtonWidth=function(e){switch(s.dm[e]){case s.dm.Small:return"120px";case s.dm.Medium:return"140px";case s.dm.Large:return"180px";default:return"120px"}}(t.coachmarkSize),this.coachmarkSource=t.coachmarkSource,this.coachmarkZIndex=t.zIndex,this.creativeId=t.creativeId,this.ctaList=t.ctaList,this.ecsFeatureFlags=t.ecsFeatureFlags,this.eventUrl=t.eventUrl,this.floatingPosition=t.floatingPosition,this.head=t.head?t.head:null,this.isEcsExperiment=t.isEcsExperiment,this.leadImage=t.leadImage,this.leadImageAltText=t.leadImageAltText,this.leadImageWidth=function(e){switch(s.dm[e]){case s.dm.Small:case s.dm.Medium:return"24px";case s.dm.Large:return"50px";default:return"24px"}}(t.coachmarkSize),this.mainImage=t.mainImage,this.mainImageAltText=t.mainImageAltText,this.mainImageHeight=function(e){switch(s.dm[e]){case s.dm.Small:return"145px";case s.dm.Medium:return"166px";case s.dm.Large:return"208px";default:return"166px"}}(t.coachmarkSize),this.mainImageWidth=function(e){switch(s.dm[e]){case s.dm.Small:return"280px";case s.dm.Medium:return"320px";case s.dm.Large:return"400px";default:return"320px"}}(t.coachmarkSize),this.name=t.name,this.creativeNamespace=t.creativeNamespace,this.pointerPosition=t.pointerPosition,this.pointerDropShadow=function(e){const t="drop-shadow(-1.5px 2px 1px rgba(0, 0, 0, 0.11))",a="drop-shadow(2.2px 1px 1px rgba(0, 0, 0, 0.11))",i=document.dir===g.N.ltr;switch(e){case s.ur.Above:return"drop-shadow(-1px 4px 1px rgba(0, 0, 0, 0.11))";case s.ur.Below:return"drop-shadow(0px -1px 1px rgba(0, 0, 0, 0.11))";case s.ur.Left:return i?a:t;case s.ur.Right:return i?t:a;default:return null}}(t.coachmarkPosition),this.pointerPoints=function(e){const t="13,0 0,13 13,26",a="0,0 13,13 0,26",i=document.dir===g.N.ltr;switch(e){case s.ur.Above:return"0,0 13,13 26,0";case s.ur.Below:return"0,13 13,0 26,13";case s.ur.Right:return i?t:a;case s.ur.Left:return i?a:t;default:return null}}(t.coachmarkPosition),this.positionId=t.positionId,this.rewardsInfo=t.rewardsInfo,this.showPointer=!t.floatingPosition&&t.showPointer,this.targetElementKey=t.targetElement,this.timeoutInMs=t.timeoutInMs,this.ctaList?(this.ctaList[0]&&(this.ctaButtonOneText=this.ctaList[0].ctaButtonText?this.ctaList[0].ctaButtonText:null,this.ctaButtonOneTelemetryTag=this.populateTelemetryTags(this.ctaList[0].ctaButtonText,this.ctaList[0].ctaType,p.wu.View,this.ctaList[0].nonLocalizedCTAText),"Navigate"===this.ctaList[0].ctaType&&this.ctaList[0].ctaButtonURL&&function(e){const t=/^((microsoft-edge:)?https:\/\/((www)|(cn)|(go)|(aka)|(ntp))\.((msn)|(bing)|(skype)|(microsoft)|(ms))(\.com)?)|(edge:\/\/)/.test(e);return t||(0,$.H)(I.GyY,"Invalid URL: "+e),t}(this.ctaList[0].ctaButtonURL)&&(this.ctaButtonOneURL=this.ctaList[0].ctaButtonURL)),this.ctaList[1]&&(this.ctaButtonTwoText=this.ctaList[1].ctaButtonText?this.ctaList[1].ctaButtonText:null,this.ctaList[1].ctaBehavior&&this.ctaList[1].ctaType?(this.isSecondaryButtonAction=!0,this.ctaButtonTwoTelemetryTag=this.populateTelemetryTags(this.ctaList[1].ctaButtonText,this.ctaList[1].ctaType,p.wu.View,this.ctaList[1].nonLocalizedCTAText)):this.ctaButtonTwoTelemetryTag=this.populateTelemetryTags(this.ctaList[1].ctaButtonText,this.ctaList[1].ctaType,p.wu.Close,this.ctaList[1].nonLocalizedCTAText))):(this.ctaButtonOneText=null,this.ctaButtonTwoText=null),this.closeButtonTelemetryTag=this.closeTelemetryTag(),this.coachmarkDialogTelemetryTag=this.coachmarkTelemetryTag(),this.addCoachmarkToPage=!!t,this.edgeNurturingAPICampaignName=t.edgeNurturingAPICampaignName)}))}coachmarkTelemetryTag(){return this.coachmarkSource===s.jX.Experience?this.coachmarkDialogTelemetryTag=new V.D({name:this.name,content:{headline:this.name,type:p.uH.Coachmark}}):new V.D({name:`${this.positionId}_${this.creativeId}_${this.name}`,content:{headline:`${this.positionId}_${this.creativeId}_${this.name}`,type:p.uH.Coachmark}})}updatePointer(e,t){if(!this.coachmarkElement||!this.coachmarkPointerElement)return;const a=this.coachmarkElement.getBoundingClientRect();let i=0,o=0;const n=this.currentLangDir===g.N.ltr;switch(e){case s.ur.Above:o=a.left+a.width/2-13,i=a.bottom;break;case s.ur.Below:o=a.left+a.width/2-13,i=a.top-h;break;case s.ur.Right:o=n?a.left-h:document.documentElement.clientWidth-a.right-26,i=a.top+a.height/2-13;break;case s.ur.Left:o=n?a.right:document.documentElement.clientWidth-a.left-h,i=a.top+a.height/2-13;break;default:return}let r=0,c=0;switch(t){case s.M_.Adjacent:switch(e){case s.ur.Above:case s.ur.Below:r=a.width/2-52+13;break;case s.ur.Left:case s.ur.Right:c=a.height/2-26-h}break;case s.M_.Center:break;case s.M_.Opposite:switch(e){case s.ur.Above:case s.ur.Below:r=-1*(a.width/2-d-13);break;case s.ur.Left:case s.ur.Right:c=-1*(a.height/2-26-h)}break;default:return void j(Object.assign(Object.assign({},I.WD2.GeneralError),{message:`Error rendering ${this.currentCoachmarkName} coachmark pointer due to invalid pointer position value`,pb:Object.assign(Object.assign({},I.WD2.GeneralError.pb),{customMessage:`Invalid pointer position value for coachmark: ${this.currentCoachmarkName} creativeId: ${this.creativeId} positionId: ${this.positionId}`})}))}this.currentPointerTopOffset=i,this.currentPointerLeftOffset=o,this.coachmarkPointerElement.style.top=(0,J.a)(i),this.coachmarkPointerElement.style.left=n?(0,J.a)(o):"auto",this.coachmarkPointerElement.style.right=n?"auto":(0,J.a)(o),r&&(n?this.coachmarkElement.style.left=(0,J.a)(a.left+r):this.coachmarkElement.style.right=(0,J.a)(a.left+r+10)),c&&(this.coachmarkElement.style.top=(0,J.a)(a.top+c))}ctaButtonKeyDownHandler(e,t=0){if(e.key===u.oM)if(e.shiftKey)e.preventDefault(),this.closeButtonElement&&this.closeButtonElement.focus();else{e.preventDefault();(this.ctaButtonTwoElement?this.ctaButtonTwoElement:this.closeButtonElement).focus()}else e.key===u.kL&&this.ctaButtonHandler(e,t,r.M.Click)}}(0,o.gn)([Q.LO],ae.prototype,"addCoachmarkToPage",void 0),(0,o.gn)([Q.LO],ae.prototype,"body",void 0),(0,o.gn)([Q.LO],ae.prototype,"closeButtonTelemetryTag",void 0),(0,o.gn)([Q.LO],ae.prototype,"closeText",void 0),(0,o.gn)([Q.LO],ae.prototype,"coachmarkWidth",void 0),(0,o.gn)([Q.LO],ae.prototype,"coachmarkButtonWidth",void 0),(0,o.gn)([Q.LO],ae.prototype,"coachmarkZIndex",void 0),(0,o.gn)([Q.LO],ae.prototype,"coachmarkDialogTelemetryTag",void 0),(0,o.gn)([Q.LO],ae.prototype,"ctaButtonOneTelemetryTag",void 0),(0,o.gn)([Q.LO],ae.prototype,"ctaButtonOneText",void 0),(0,o.gn)([Q.LO],ae.prototype,"ctaButtonOneURL",void 0),(0,o.gn)([Q.LO],ae.prototype,"ctaButtonTwoTelemetryTag",void 0),(0,o.gn)([Q.LO],ae.prototype,"ctaButtonTwoText",void 0),(0,o.gn)([Q.LO],ae.prototype,"isSecondaryButtonAction",void 0),(0,o.gn)([Q.LO],ae.prototype,"showPointer",void 0),(0,o.gn)([Q.LO],ae.prototype,"leadImage",void 0),(0,o.gn)([Q.LO],ae.prototype,"leadImageAltText",void 0),(0,o.gn)([Q.LO],ae.prototype,"leadImageWidth",void 0),(0,o.gn)([Q.LO],ae.prototype,"mainImage",void 0),(0,o.gn)([Q.LO],ae.prototype,"mainImageAltText",void 0),(0,o.gn)([Q.LO],ae.prototype,"mainImageHeight",void 0),(0,o.gn)([Q.LO],ae.prototype,"mainImageWidth",void 0),(0,o.gn)([Q.LO],ae.prototype,"pointerDropShadow",void 0),(0,o.gn)([Q.LO],ae.prototype,"pointerPoints",void 0),(0,o.gn)([Q.LO],ae.prototype,"renderCoachmark",void 0),(0,o.gn)([Q.LO],ae.prototype,"head",void 0),(0,o.gn)([Q.LO],ae.prototype,"coachmarkHeight",void 0);var ie=a(49218),oe=a(93703);const ne=ie.dy`<img alt=${e=>e.leadImageAltText} class="coachmark_lead_image" src=${e=>e.leadImage} style="width:${e=>e.leadImageWidth}" role="presentation" />`,re=ie.dy`<img alt=${e=>e.mainImageAltText} class="coachmark-mainImage" src=${e=>e.mainImage} style="height:${e=>e.mainImageHeight};width:${e=>e.mainImageWidth}" role="presentation" />`,se=ie.dy`<div class="pointerContainer"><svg class="pointer" height="26" id="coachmarkPointerElement" style="filter:${e=>e.pointerDropShadow}" viewBox="0 0 26 26" width="26"><polygon points="${e=>e.pointerPoints}"></polygon></svg></div>`,ce=ie.dy` ${(0,oe.g)((e=>e.mainImage),re)}
`,he=ie.dy`<fluent-button appearance="accent" aria-label=${e=>e.ctaButtonOneText} role="button" class="ctaButton" style="width:${e=>e.coachmarkButtonWidth}" id="ctaButton" tabindex="0" title=${e=>e.ctaButtonOneText} @click=${(e,t)=>e.ctaButtonHandler(t.event,0,null)} @keydown=${(e,t)=>e.ctaButtonKeyDownHandler(t.event,0)} data-t="${e=>e.ctaButtonOneTelemetryTag.getMetadataTag()}">${e=>e.ctaButtonOneText}</fluent-button>`,de=ie.dy`<fluent-anchor appearance="accent" aria-label=${e=>e.ctaButtonOneText} class="ctaButton" style="width:${e=>e.coachmarkButtonWidth}" href=${e=>e.ctaButtonOneURL} id="ctaButton" tabindex="0" target="_blank" title=${e=>e.ctaButtonOneText} @click=${(e,t)=>e.ctaButtonHandler(t.event,0,null)} @keydown=${(e,t)=>e.ctaButtonKeyDownHandler(t.event,0)} data-t="${e=>e.ctaButtonOneTelemetryTag.getMetadataTag()}">${e=>e.ctaButtonOneText}</fluent-anchor>`,le=ie.dy`<fluent-button appearance="neutral" aria-label=${e=>e.ctaButtonTwoText} role="button" class="ctaButton" style="width:${e=>e.coachmarkButtonWidth}" id="ctaButtonTwo" tabindex="0" title=${e=>e.ctaButtonTwoText} @click=${(e,t)=>e.isSecondaryButtonAction?e.ctaButtonHandler(t.event,1,null):e.closeCoachmark(t.event,r.M.Dismiss,p.Aw.Click,p.wu.Hide,!0)} @keydown=${(e,t)=>e.isSecondaryButtonAction?e.ctaButtonKeyDownHandler(t.event,1):e.lastElementKeyDownHandler(t.event)} data-t="${e=>e.ctaButtonTwoTelemetryTag.getMetadataTag()}">${e=>e.ctaButtonTwoText}</fluent-button>`,me=ie.dy`<div class="footer-actions">${(0,oe.g)((e=>e.ctaButtonOneText&&!e.ctaButtonOneURL),he)} ${(0,oe.g)((e=>e.ctaButtonOneText&&e.ctaButtonOneURL),de)} ${(0,oe.g)((e=>e.ctaButtonTwoText),le)}</div>`,ue=ie.dy`<div class="coachmark">${(0,oe.g)((e=>e.showPointer),se)}<fluent-dialog class="dialog" id="coachmarkElement" role="dialog" aria-label=${e=>e.head} part="dialog" style="width:${e=>e.coachmarkWidth}" @keydown=${(e,t)=>e.keyDownHandler(t.event)} data-t="${e=>e.coachmarkDialogTelemetryTag.getMetadataTag()}" modal="${e=>e.isModal}">${(0,oe.g)((e=>e.showPointer||e.mainImage),ce)}<div class="main-container"><div class="coachmark_content"><div class="${e=>e.leadImage?"header_lead_image":"header"}">${(0,oe.g)((e=>e.leadImage),ne)}<div class="coachmark_title_head_container"><h1 class="coachmark_title" tabindex="0" aria-label=${e=>e.head}>${e=>e.head}</h1><div class="input-container" tabindex="0" aria-label=${e=>e.body}>${e=>e.body}</div></div></div></div>${(0,oe.g)((e=>e.ctaButtonOneText||e.ctaButtonTwoText),me)}</div><fluent-button appearance="stealth" aria-label=${e=>e.closeText} role="button" class="close-button ${e=>e.mainImage?"close-button-with-img":""}" id="closeButton" tabindex="0" title=${e=>e.closeText} @click=${(e,t)=>{e.closeButtonHandler(),e.closeCoachmark(t.event,r.M.Dismiss,p.Aw.Click,p.wu.Close,!1,!0)}} @keydown=${(e,t)=>{e.closeButtonHandler(),e.closeButtonKeyDownHandler(t.event)}} data-t="${e=>e.closeButtonTelemetryTag.getMetadataTag()}"><svg viewBox="0 0 16 16" width="16px" height="16px" xmlns="http://www.w3.org/2000/svg"><path d="M14.1016 1.60156L8.20312 7.5L14.1016 13.3984L13.3984 14.1016L7.5 8.20312L1.60156 14.1016L0.898438 13.3984L6.79688 7.5L0.898438 1.60156L1.60156 0.898438L7.5 6.79688L13.3984 0.898438L14.1016 1.60156Z"></path></svg></fluent-button></fluent-dialog></div>`,ge=ie.dy` ${(0,oe.g)((e=>e.addCoachmarkToPage),ue)}
`;var pe=a(42689),ke=a(53131),ve=a(27782),fe=a(27460),Ce=a(22674),ye=a(78923);const we=ye.i` .close-button{left:auto;right:4px}.coachmark_lead_image{margin-left:auto;margin-right:16px}`,be=ye.i` .close-button{left:4px;right:auto}.coachmark_lead_image{margin-left:16px;margin-right:auto}`,Te=ye.i` .close-button{background:transparent;height:24px;min-width:24px;position:absolute;top:4px}.close-button::part(control){margin:0;padding:0}.close-button svg{height:12px;width:12px}.close-button-with-img svg{color:rgb(38,38,38)}.coachmark:{z-index:var(--top-site-dialog-z-index)}.coachmark-mainImage{display:grid;-webkit-user-drag:none}.coachmark_content{display:grid;grid-template-columns:max-content auto}.ctaButton{font-size:12px;height:auto;line-height:16px;min-height:32px}.ctaButton::part(control){white-space:normal;word-break:break-word}.dialog{bottom:var(--dialog-bottom,auto);left:var(--dialog-left,auto);position:fixed;right:var(--dialog-right,auto);top:var(--dialog-top,auto);--dialog-height:var(--top-site-dialog-height,auto)}fluent-dialog::part(positioning-region){border-radius:2px;overflow:unset;position:var(--dialog-position,relative);width:inherit}fluent-dialog::part(control){border:none;height:auto;width:auto}.footer-actions{margin-top:14px;width:100%;display:flex;justify-content:space-between}.header{grid-column:2;grid-row:1;letter-spacing:0.6px;line-height:20px}.header_lead_image:has(> img){grid-column:2}.header_lead_image{display:grid;grid-column:2;grid-row:1}.coachmark_lead_image{grid-column:1;grid-row:1}.coachmark_title_head_container{display:grid;grid-column:2;grid-row:1;letter-spacing:0.6px;line-height:20px;text-align:left}.coachmark_title{letter-spacing:0.6px;line-height:24px;margin-bottom:12px;-webkit-user-select:none}.input-container{color:${pe.C};
        font-family: ${ke.S};
        font-size: ${ve.c};justify-content:space-between;line-height:20px;-webkit-user-select:none}:host{position:relative;--control-corner-radius:2;--dialog-z-index:0;--layer-corner-radius:4}h1{color:${pe.C};cursor:default;font-size:16px;font-weight:600;line-height:20px;margin-bottom:0;margin-top:0}.main-container{background-color:${fe.s};display:grid;padding:14px 16px}.pointer{fill:var(--neutral-layer-floating);position:fixed;z-index:2}.pointerContainer{height:13px}`.withBehaviors(new Ce.O(we,be)),Ee={experienceConfigSchema:undefined}},90042:function(e,t,a){a.d(t,{S:function(){return l}});var i=a(33940),o=a(65135),n=a(17440),r=a(75192),s=a(26415),c=a(27003),h=a(99590);class d{constructor(e){this.userNurturingManager=e}static getInstance(){return c.Gq.get("__LocalCoachmarkStorageManager__",(()=>new d(n.H.getInstance())))}getAllLocalCoachmarkCampaignsByKey(e){return(0,i.mG)(this,void 0,void 0,(function*(){if(!(yield this.userNurturingManager.isApiAvailableToUse()))return this.sendClientLogEvent(`User's preference for local campaign ${e} could not be fetched.`),this.buildKeyErrorResponse();const t=yield this.userNurturingManager.getPreferenceSetting(e);return t&&t.value}))}getLocalCoachmarkCampaignByKeyAndName(e,t){return(0,i.mG)(this,void 0,void 0,(function*(){if(!(yield this.userNurturingManager.isApiAvailableToUse()))return this.sendClientLogEvent(`User's preference for local campaign ${e} and name ${t} could not be fetched.`),this.buildErrorResponse();const a=yield this.userNurturingManager.getPreferenceSetting(e),i=a&&a.value;return i&&i.find((e=>e&&e.name===t))}))}setLocalCoachmarkCampaignByKeyAndName(e,t,a,o){return(0,i.mG)(this,void 0,void 0,(function*(){if(!(yield this.userNurturingManager.isApiAvailableToUse()))return void this.sendClientLogEvent(`User's preference for local campaign key ${e} and name ${t} could not be set.`);const i=yield this.userNurturingManager.getPreferenceSetting(e),n=i&&i.value?i.value:[],r=n.find((e=>e&&e.name===t)),s=n.indexOf(r),c=r&&r.count||0,h={name:t,count:c+1,source:a,time:o||(new Date).getTime()};s>-1?n[s]=h:n.push(h),this.userNurturingManager.savePreferenceSetting(e,n)}))}clearLocalCoachmarkCampaignByKeyAndName(e,t){return(0,i.mG)(this,void 0,void 0,(function*(){if(!(yield this.userNurturingManager.isApiAvailableToUse()))return void this.sendClientLogEvent(`User's preference for local campaign ${e} and name ${t} could not be cleared.`);const a=yield this.userNurturingManager.getPreferenceSetting(e),i=a&&a.value,o=i&&i.filter((e=>e&&e.name!==t));o&&this.userNurturingManager.savePreferenceSetting(e,o)}))}clearAllLocalCoachmarkCampaignsByKey(e){return(0,i.mG)(this,void 0,void 0,(function*(){(yield this.userNurturingManager.isApiAvailableToUse())?this.userNurturingManager.deleteKeyValueFromPSL(e):this.sendClientLogEvent(`User's preference for local campaign ${e} could not be cleared.`)}))}sendClientLogEvent(e,t){const a={message:e,type:"information",pb:Object.assign(Object.assign({},(0,s.mnt)()),{customMessage:t})};o.M0.sendClientLogEvent(a)}buildKeyErrorResponse(){return[this.buildErrorResponse(!0)]}buildErrorResponse(e=!1){const t=e?"getAllLocalCoachmarkCampaignsByKey":"clearLocalCoachmarkCampaignByKeyAndName";return{count:-1,name:r.rr.apiError,source:t,time:(new Date).getTime()}}}const l=(0,h.h)(d)},35618:function(e,t,a){a.d(t,{Ar:function(){return r},He:function(){return d},L$:function(){return h},Pg:function(){return u},Y0:function(){return n},gn:function(){return o},rp:function(){return i},t9:function(){return l},u3:function(){return c},xG:function(){return m},xn:function(){return s}});const i="myfeed",o=760,n=300,r="OptInStickPromptLoad",s="OnLoadAutoScrollPrompt",c="OptInStickMetadata",h="OnLoadAutoScrollMetadata",d="sticky_peek",l=6,m=30,u=new Set([r,s])},53146:function(e,t,a){a.d(t,{H:function(){return k},Ms:function(){return v},WL:function(){return y},Wi:function(){return m},Wr:function(){return p},cj:function(){return C},oW:function(){return d},pS:function(){return l}});var i=a(33940),o=a(90042),n=a(58155),r=a(70694),s=a(65337),c=a(35618),h=a(12884);function d(e,t){return function(e){return c.Pg.has(e)}(e)&&t<=c.gn}function l(e,t){if(!e||void 0===(null==t?void 0:t.selectedFeedDisplaySetting))return c.Ar;return e&&e.find((e=>e&&e.name===c.Ar))&&"headingsonly"===(null==t?void 0:t.selectedFeedDisplaySetting)?c.xn:c.Ar}function m(e,t,a,i,o){if("always"===(null==t?void 0:t.selectedFeedDisplaySetting))return!1;if(!n.c.getQueryParameterByName("vptest",(0,h.zp)())&&!a&&o<c.t9)return!1;if(t.isContentFeedManagedByPolicy||!t.market||"ru-ru"===t.market.toLowerCase())return!1;const d=null==a?void 0:a.find((e=>e&&e.name===c.Ar)),l=null==a?void 0:a.find((e=>e&&e.name===c.xn)),m=((null==d?void 0:d.count)||0)+((null==l?void 0:l.count)||0);if(!u(d)||!u(l)||m>2)return!1;const p=innerHeight>c.gn;return!(!t||r.p.isDhpPage()||!p||i&&i.toLocaleLowerCase()!==c.rp)&&function(e,t,a){const i=(0,s.$o)().getObject(g(e));if(!i)return!0;return i.nextEligible<t&&i.timesSeen<a}(e,(new Date).getTime(),3)}function u(e){if(!e)return!0;return(new Date).getTime()>new Date(e.time+24*c.xG*60*60*1e3).getTime()}function g(e){return e===c.xn?c.L$:c.u3}function p(e){const t=g(e);let a=(0,s.$o)().getObject(t);a||(a={nextEligible:0,timesSeen:0});const i=a&&a.timesSeen+1,o=(new Date).getTime(),n=new Date(o+24*c.xG*60*60*1e3).getTime();a.timesSeen=i,a.nextEligible=n,(0,s.$o)().setObject(t,a)}function k(){let e=(0,s.$o)().getItem("spVisitsMetadata")?+(0,s.$o)().getItem("spVisitsMetadata"):0;return e++,(0,s.$o)().setItem("spVisitsMetadata",e.toString()),e}function v(){return(0,i.mG)(this,void 0,void 0,(function*(){return o.S.getAllLocalCoachmarkCampaignsByKey(c.He)}))}function f(){return(0,i.mG)(this,void 0,void 0,(function*(){yield o.S.clearAllLocalCoachmarkCampaignsByKey(c.He)}))}function C(){return"1"===n.c.getQueryParameterByName("forceImageTest",(0,h.zp)())||"1"===n.c.getQueryParameterByName("vptest",(0,h.zp)())||"vp"===n.c.getQueryParameterByName("reqsrc",(0,h.zp)())}function y(){return(0,i.mG)(this,void 0,void 0,(function*(){const e=n.c.getQueryParameterByName("clearStickyPeekPref",(0,h.zp)());e?yield function(e){return(0,i.mG)(this,void 0,void 0,(function*(){yield o.S.clearLocalCoachmarkCampaignByKeyAndName(c.He,e)}))}(e):"1"===n.c.getQueryParameterByName("clearAllStickyPeekPrefs",(0,h.zp)())&&(yield f());n.c.getQueryParameterByName("isAutoScrollTest",(0,h.zp)())&&((0,s.$o)().removeItem(c.u3),(0,s.$o)().removeItem(c.L$),yield f(),yield o.S.setLocalCoachmarkCampaignByKeyAndName(c.He,c.Ar,"ntp",1))}))}}}]);