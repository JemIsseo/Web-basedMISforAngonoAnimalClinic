"use strict";(self.webpackChunk_msnews_msnews_experiences=self.webpackChunk_msnews_msnews_experiences||[]).push([["super-coach-mark-wc"],{95386:function(t,e,i){i.r(e),i.d(e,{SuperCoachMarkWC:function(){return E},SuperCoachMarkWCStyles:function(){return lt},SuperCoachMarkWCTemplate:function(){return et},ToolingInfo:function(){return ct}});var o=i(33940),a=i(85068),s=i(96324),n=i(86331),r=i(87230),l=i(503),c=i(59997);class h{constructor(t,e,i,o,a,s=!1){this.isRTL=c.N.rtl===document.dir,this.coachmarkSize=t,this.floatingPosition=e,this.anchoringPosition=i,this.hasPointer=o,this.pointerPosition=a,this.topOffset=0,this.startOffset=0,this.topOffset4Pointer=0,this.startOffset4Pointer=0,this.allowExceedingBoundary=s}calcPosition(t,e,i){if(!this.floatingPosition&&!this.anchoringPosition||!this.coachmarkSize||!e&&!this.floatingPosition)return!1;const o=t.getBoundingClientRect(),a=null==e?void 0:e.getBoundingClientRect(),s=i.getBoundingClientRect(),r=this.hasPointer?l.CR:0,c=10;if(this.floatingPosition)switch(this.floatingPosition){case n.pY.TopEnd:this.topOffset=c,this.startOffset=o.right-s.width-c;break;case n.pY.TopStart:this.topOffset=c,this.startOffset=c;break;case n.pY.BottomEnd:this.topOffset=window.innerHeight-s.height-c,this.startOffset=o.right-s.width-c;break;case n.pY.BottomStart:this.topOffset=window.innerHeight-s.height-c,this.startOffset=c}else{switch(this.anchoringPosition){case n.RC.Above:this.topOffset=a.top-s.height-r,this.startOffset=a.left+a.width/2-s.width/2;break;case n.RC.Below:this.topOffset=a.bottom+r,this.startOffset=a.left+a.width/2-s.width/2;break;case n.RC.Right:this.topOffset=a.top+a.height/2-s.height/2,this.startOffset=this.isRTL?a.left-s.width-r:a.right+r;break;case n.RC.Left:this.topOffset=a.top+a.height/2-s.height/2,this.startOffset=this.isRTL?a.right+r:a.left-s.width-r;break;default:return!1}if(this.hasPointer){switch(this.anchoringPosition){case n.RC.Above:this.topOffset4Pointer=a.top-l.CR,this.startOffset4Pointer=a.left+a.width/2-l.Mx/2;break;case n.RC.Below:this.topOffset4Pointer=a.bottom,this.startOffset4Pointer=a.left+a.width/2-l.Mx/2;break;case n.RC.Right:this.topOffset4Pointer=a.top+a.height/2-l.Mx/2,this.startOffset4Pointer=this.isRTL?a.left-l.CR:a.right;break;case n.RC.Left:this.topOffset4Pointer=a.top+a.height/2-l.Mx/2,this.startOffset4Pointer=this.isRTL?a.right:a.left-l.CR;break;default:return!1}switch(this.pointerPosition){case n.Jt.Adjacent:switch(this.anchoringPosition){case n.RC.Above:case n.RC.Below:this.startOffset+=this.isRTL?s.width/2*-1+3*l.Mx/2:s.width/2-3*l.Mx/2;break;case n.RC.Left:case n.RC.Right:this.topOffset+=s.height/2-3*l.Mx/2}break;case n.Jt.Center:break;case n.Jt.Opposite:switch(this.anchoringPosition){case n.RC.Above:case n.RC.Below:this.startOffset+=this.isRTL?s.width/2-3*l.Mx/2:s.width/2*-1+3*l.Mx/2;break;case n.RC.Left:case n.RC.Right:this.topOffset+=s.height/2*-1+3*l.Mx/2}}}}return!((this.topOffset<0||this.startOffset<0||this.topOffset+s.height>o.bottom||this.startOffset+s.width>o.right)&&!this.allowExceedingBoundary)}getTopOffset(){return this.topOffset}getStartOffset(){return this.startOffset}getTopOffset4Pointer(){return this.topOffset4Pointer}getStartOffset4Pointer(){return this.startOffset4Pointer}getWidth(){return(0,n.no)(this.coachmarkSize)}getPoints(){return(0,n.Er)(this.anchoringPosition,this.isRTL)}getPointerDropShadow(){return(0,n.p4)(this.anchoringPosition,this.isRTL)}}var d=i(64893),m=i(83227),u=i(65135),g=i(38156),p=i(49218),f=i(99452),k=i(42590),v=i(9533),b=i(81555),y=i(58958),C=i(87711);const w="CoachMarkContainer",P="DismissButton",M="ConfirmButton",L="CancelButton",B="Link";class S{constructor(t,e){this.rootTelemetryObject=t,t&&(this.superCoachTelemetryObject=this.rootTelemetryObject,this.superCoachTelemetryMetaTag=this.superCoachTelemetryObject.getMetadataTag(),this.superCoachMarkContainerTelemetryMetaTag=this.superCoachTelemetryObject.addOrUpdateChild({name:e+"_"+w,behavior:g.wu.Show,action:g.Aw.View,content:{headline:w}}).getMetadataTag(),this.dismissButtonTelemetryMetaTag=this.superCoachTelemetryObject.addOrUpdateChild({name:e+"_"+P,behavior:g.wu.Close,action:g.Aw.Click,content:{headline:P}}).getMetadataTag(),this.confirmButtonTelemetryMetaTag=this.superCoachTelemetryObject.addOrUpdateChild({name:e+"_"+M,behavior:g.wu.Close,action:g.Aw.Click,content:{headline:M}}).getMetadataTag(),this.cancelButtonTelemetryMetaTag=this.superCoachTelemetryObject.addOrUpdateChild({name:e+"_"+L,behavior:g.wu.Cancel,action:g.Aw.Click,content:{headline:L}}).getMetadataTag(),this.linkTelemetryMetaTag=this.superCoachTelemetryObject.addOrUpdateChild({name:e+"_"+B,behavior:g.wu.Navigate,action:g.Aw.Click,content:{headline:B}}).getMetadataTag())}}var O=i(64193),x=i(35357);const T=[{body:"Ready for something new? Hit refresh",coachMarkKey:"prong2RefreshButton",coachmarkAnchoringPosition:"Below",dismissButtonLabel:"Dismiss",dismissEvents:"Outside",hasPointer:!0,head:"Content refresh",localizationId:"prong2RefreshButton",maxShowTimes:3,pointerPosition:"Opposite",repeatHours:24,size:"Large"},{body:"This layout features news and other stories based on your interests. Want to keep it?",cancelButtonLabel:"No thanks",coachMarkKey:"layoutPromotion",coachmarkAnchoringPosition:"Below",confirmButtonLabel:"Keep layout",coverUrl:"http://img-s-msn-com.akamaized.net/tenant/amp/entityId/AASvpz5.img",darkCoverUrl:"http://img-s-msn-com.akamaized.net/tenant/amp/entityId/AASvssI.img",dismissButtonLabel:"Dismiss",dismissEvents:"Outside",hasPointer:!0,head:"Like our new look?",localizationId:"layoutPromotion",maxShowTimes:3,pointerPosition:"Opposite",repeatHours:24,showCancelButton:!0,showConfirmButton:!0,size:"Large"},{autoDismiss:15,body:"To switch to another quick links layout, go to settings.",cancelButtonLabel:"Change it",coachMarkKey:"topSitesPromotion",coachmarkAnchoringPosition:"Below",confirmButtonLabel:"Like",dismissButtonLabel:"Dismiss",dismissEvents:"Outside",hasPointer:!0,head:"Like this new quick links layout?",localizationId:"topSitesPromotion",maxShowTimes:1,pointerPosition:"Adjacent",repeatHours:24,showCancelButton:!0,showConfirmButton:!0,size:"Large"},{autoDismiss:15,body:"To switch to another quick links layout, go to settings.",cancelButtonLabel:"Change it",coachMarkKey:"topSitesPromotionV2",coachmarkAnchoringPosition:"Below",confirmButtonLabel:"Like",dismissButtonLabel:"Dismiss",dismissEvents:"Target",hasPointer:!0,head:"Like this new quick links layout?",localizationId:"topSitesPromotion",maxShowTimes:1,pointerPosition:"Adjacent",repeatHours:24,showCancelButton:!0,showConfirmButton:!0,size:"Large"},{autoDismiss:15,body:"Select {BellIcon} to view them",coachMarkKey:"notificationBellPromotionWinHP",coachmarkAnchoringPosition:"Below",dismissButtonLabel:"Dismiss",dismissEvents:"OutsideAndTarget",hasPointer:!0,head:"You have new notifications",localizationId:"notificationBellPromotion",maxShowTimes:1,pointerPosition:"Opposite",repeatHours:0,size:"Medium"},{autoDismiss:15,body:"你可以在“设置”中重新开启网址导航",cancelButtonLabel:"重新启用",coachMarkKey:"recommendedSitesSelection",coachmarkAnchoringPosition:"Below",confirmButtonLabel:"保持关闭",dismissButtonLabel:"关闭",dismissEvents:"Outside",hasPointer:!0,head:"网址导航已关闭",localizationId:"recommendedSitesSelection",maxShowTimes:1,pointerPosition:"Opposite",repeatHours:24,showCancelButton:!0,showConfirmButton:!0,size:"Large"},{autoDismiss:15,body:"你可以在“设置”中重新开启网址导航",cancelButtonLabel:"重新启用",coachMarkKey:"recommendedSitesPromotionOff",coachmarkAnchoringPosition:"Below",confirmButtonLabel:"保持关闭",dismissButtonLabel:"关闭",dismissEvents:"Outside",hasPointer:!0,head:"网址导航已关闭",localizationId:"recommendedSitesPromotionOff",maxShowTimes:1,pointerPosition:"Opposite",repeatHours:24,showCancelButton:!0,showConfirmButton:!0,size:"Large"},{autoDismiss:15,body:"你可以在“设置”中设置网址导航样式",cancelButtonLabel:"改回",coachMarkKey:"recommendedSitesPromotionNewLine",coachmarkAnchoringPosition:"Below",confirmButtonLabel:"保留样式",dismissButtonLabel:"关闭",dismissEvents:"Outside",hasPointer:!0,head:"网址导航新样式",localizationId:"recommendedSitesPromotionNewLine",maxShowTimes:1,pointerPosition:"Opposite",repeatHours:24,showCancelButton:!0,showConfirmButton:!0,size:"Large"},{autoDismiss:15,body:"We use your location to deliver accurate local news, weather, and personalized content",cancelButtonLabel:"Edit",coachMarkKey:"locationAccuracyRevIP",coachmarkAnchoringPosition:"Below",confirmButtonLabel:"Yes",dismissButtonLabel:"Dismiss",dismissEvents:"Outside",hasPointer:!0,head:"Did we get your location right?",localizationId:"locationAccuracy",maxShowTimes:3,pointerPosition:"Adjacent",repeatHours:24,showCancelButton:!0,showConfirmButton:!0,size:"Medium",usePSL:!0},{body:"Choose your preferred region and language.",cancelButtonLabel:"Not now",coachMarkKey:"marketLanguage",coachmarkAnchoringPosition:"Below",confirmButtonLabel:"Save",dismissEvents:"Outside",hasPointer:!0,head:"Not the right language?",localizationId:"marketLanguage",pointerPosition:"Opposite",repeatHours:0,showCancelButton:!0,showConfirmButton:!0,showDropDownMenu:!0,size:"Medium"},{body:"The interests you choose will show up in Following",cancelButtonLabel:"Maybe later",coachMarkKey:"followingFeedPromotion",coachmarkAnchoringPosition:"Above",confirmButtonLabel:"See it now",dismissEvents:"Outside",hasPointer:!0,head:"See what you care about",localizationId:"followingFeedPromotion",maxShowTimes:3,pointerPosition:"center",repeatHours:72,showCancelButton:!0,showConfirmButton:!0,size:"Medium"},{autoDismiss:15,body:"Add a location to see local news from that area",coachMarkKey:"multiLocationsCarouselV2",coachmarkAnchoringPosition:"Below",dismissButtonLabel:"Dismiss",dismissEvents:"Target",hasPointer:!0,head:"Want to see local news from more locations?",localizationId:"multiLocationsCarouselV2",maxShowTimes:5,pointerPosition:"Adjacent",repeatHours:0,size:"Small"},{body:"Get gaming news, esports updates, videos and more based on what you like. With the new gaming tab, access the cloud and explore more games all in one place.",cancelButtonLabel:"Maybe later",coachMarkKey:"gamingFeedPromotion",coachmarkAnchoringPosition:"Above",confirmButtonLabel:"Try it now",dismissEvents:"Outside",hasPointer:!0,head:"A new feed for gamers",localizationId:"gamingFeedPromotion",maxShowTimes:3,pointerPosition:"center",repeatHours:168,showCancelButton:!0,showConfirmButton:!0,size:"Large",storePSL:!0},{autoDismiss:15,body:"You can now find them here.",coachMarkKey:"officeApp",coachmarkAnchoringPosition:"Below",dismissButtonLabel:"Dismiss",dismissEvents:"OutsideAndTarget",hasPointer:!0,head:"Looking for your Microsoft 365 apps?",localizationId:"officeApp",maxShowTimes:3,pointerPosition:"Adjacent",repeatHours:24,size:"Medium"},{coachMarkKey:"informationalSwitchOffer",localizationId:"informationalSwitchOffer",scope:"NTP",head:"Try a new layout to see more news!",body:"Earn 100 Microsoft Rewards points when you switch to the Microsoft Edge informational layout. Plus, earn 400 more if you keep it for 7 days.",confirmButtonLabel:"Switch layout",dismissButtonLabel:"Dismiss",cancelButtonLabel:"Maybe later",size:"Medium",coachmarkAnchoringPosition:"Below",hasPointer:!0,pointerPosition:"Opposite",dismissEvents:"OutsideAndTarget",maxShowTimes:2,repeatHours:168,showConfirmButton:!0,showCancelButton:!0,coverUrl:"http://img-s-msn-com.akamaized.net/tenant/amp/entityid/AA10NUSe.img",darkCoverUrl:"http://img-s-msn-com.akamaized.net/tenant/amp/entityid/AA10NUSe.img",storePSL:!0,parentCampaignId:"ENUS_infomode_switch_keep_s1_100"},{coachMarkKey:"informationalSwitchCompletion",localizationId:"informationalSwitchCompletion",scope:"NTP",head:"You earned 100 Rewards points!",body:"Thanks for switching to the informational layout in Microsoft Edge. Keep it for 7 days and earn 400 more.",dismissButtonLabel:"Dismiss",size:"Medium",coachmarkAnchoringPosition:"Below",hasPointer:!0,pointerPosition:"Opposite",dismissEvents:"OutsideAndTarget",maxShowTimes:1,showConfirmButton:!1,showCancelButton:!1,coverUrl:"http://img-s-msn-com.akamaized.net/tenant/amp/entityid/AA127r3W.img",darkCoverUrl:"http://img-s-msn-com.akamaized.net/tenant/amp/entityid/AA127r3W.img",storePSL:!0,parentCampaignId:"ENUS_infomode_switch_keep_s1_100"},{coachMarkKey:"informationalKeepCompletion",localizationId:"informationalKeepCompletion",scope:"NTP",head:"You've earned your 500 Rewards points!",body:"You just received 400 bonus points on top of the 100 earned earlier for switching to the informational layout.",dismissButtonLabel:"Dismiss",size:"Medium",coachmarkAnchoringPosition:"Below",hasPointer:!0,pointerPosition:"Opposite",dismissEvents:"OutsideAndTarget",maxShowTimes:1,showConfirmButton:!1,showCancelButton:!1,coverUrl:"http://img-s-msn-com.akamaized.net/tenant/amp/entityid/AA10NUSe.img",darkCoverUrl:"http://img-s-msn-com.akamaized.net/tenant/amp/entityid/AA10NUSe.img",storePSL:!0,parentCampaignId:"ENUS_infomode_switch_keep_s2_400"}];var A=i(71443),D=i(75384);class E extends O.l{constructor(){super(...arguments),this.surfaceType=a.US.Coachmark,this.supportedContentTypes=[a.JK.CallToAction],this.availableData=[],this.dataFromIris=[],this.nextCoachmark=new Map,this.scrollResizeHandler=this.handleScrollResize.bind(this),this.visible=!1,this.dialogStyles={left:-1e3,top:-1e3,width:0},this.pointerStyles={left:-712,top:-1008},this.points="",this.dropShadow="",this.dialogConfirmButtonLabel="",this.dialogConfirmButtonUrl="",this.dialogCancelButtonLabel="",this.dialogDismissButtonLabel="",this.dismissEvents=n.OD.Outside,this.showConfirmButton=!1,this.showCancelButton=!1,this.showDropDownMenu=!1,this.callback=(t,e,i=!1)=>(0,o.mG)(this,void 0,void 0,(function*(){if(!e||!t)return;if(this.visible&&this.coachMarkKey!=t)return void this.nextCoachmark.set(t,e);if(this.visible&&this.coachMarkKey===t&&this.updateCallbacks(e),e.anchorElementUpdated)return void this.updateStyles(e);(yield this.updateProps(t,e,i))&&(this.updateCallbacks(e),(0,x.hI)()?window.addEventListener(A.C,(()=>{this.showCoachMark(e)})):requestAnimationFrame((()=>{this.showCoachMark(e,i)})))})),this.showCoachMark=(t,e=!1)=>(0,o.mG)(this,void 0,void 0,(function*(){var i;if(!this.coachMarkKey||!e&&this.visible||!this.rootElement||!t||!t.triggerMessageReceived||!this.coachmarkHandler||!this.coachMarkDialog)return;if(!this.updateStyles(t))return void(this.visible=!1);if(null===(i=this.config.hideForControlFlight)||void 0===i?void 0:i[this.coachMarkKey])return u.M0.addOrUpdateTmplProperty(`scm_candidate_${this.coachMarkKey}`,"0"),void(e||(yield this.afterCoachMarkShow()));u.M0.addOrUpdateTmplProperty(`scm_candidate_${this.coachMarkKey}`,"1"),this.points=this.coachmarkHandler.getPoints(),this.dropShadow=this.coachmarkHandler.getPointerDropShadow(),e||(yield this.afterCoachMarkShow()),this.visible=!0,window.addEventListener("resize",this.scrollResizeHandler),window.addEventListener("scroll",this.scrollResizeHandler);const o=t.anchorElement;if(this.dismissEvents)switch(this.dismissEvents){case n.OD.Outside:window.addEventListener("click",this.handleClick);break;case n.OD.Target:o&&o.addEventListener("click",(t=>{this.hideCoachMark(t,!0)}));break;case n.OD.OutsideAndTarget:window.addEventListener("click",this.handleClick),o&&o.addEventListener("click",(t=>{this.hideCoachMark(t,!0)}))}this.autoDismiss&&this.autoDismiss>0&&!this.config.isInternal&&setTimeout((()=>{this.visible&&(this.hideCoachMark(),this.areCoachmarksEnabled([n.gz.LocationAccuracyRevIP])&&this.dismissCallback&&this.dismissCallback(),u.M0.sendClientLogEvent({message:`Coach mark for ${this.coachMarkKey} auto dismissed.`,type:"information"}),u.M0.addOrUpdateTmplProperty(`scm_autodismiss_${this.coachMarkKey}`,"1"))}),1e3*this.autoDismiss)})),this.hideCoachMark=(t,e=!1)=>{var i;if(this.coachMarkKey)return(null===(i=this.coachMarkKey)||void 0===i?void 0:i.startsWith("marketLanguage"))||r.W.getInstance().setCoachMarkClosed(this.coachMarkKey,e),this.visible=!1,this.hideCallback&&this.hideCallback(),this.removeListeners(),this.showNext(),!0},this.isInCocahMarkDialog=t=>!!t&&t.composedPath().some((t=>"SUPER-COACH-MARK"===t.tagName)),this.handleClick=t=>{var e,i,o,a,s,n,r;if(this.coachMarkDialog&&this.visible){if(null===(e=this.coachMarkKey)||void 0===e?void 0:e.startsWith("marketLanguage")){const e=null===(n=null===(s=null===(a=null===(o=null===(i=this.shadowRoot)||void 0===i?void 0:i.activeElement)||void 0===o?void 0:o.shadowRoot)||void 0===a?void 0:a.activeElement)||void 0===s?void 0:s.shadowRoot)||void 0===n?void 0:n.getElementById("marketSelector"),l=null===(r=this.shadowRoot)||void 0===r?void 0:r.getElementById("superCoachMark"),c=t.composedPath();if(c&&(l&&c.includes(l)||e&&c.includes(e)))return}this.isInCocahMarkDialog(t)||!0!==this.visible||(u.M0.sendActionEvent(this,g.Aw.Click,g.wu.Hide),this.handleDismiss())}},this.backgroundColorChangeHandler=()=>{this.coverUrl=(0,y.Y)()?this.darkModeCoverUrl:this.lightModeCoverUrl}}experienceConnected(){return(0,o.mG)(this,void 0,void 0,(function*(){(0,D.lr)().then((()=>(0,o.mG)(this,void 0,void 0,(function*(){var t,e,i;(null===(t=this.config)||void 0===t?void 0:t.skipCoachmarkTimeout)||(yield(0,C.Kb)(3e3));const o=document.querySelector(this.config.rootSelector);o&&(this.rootElement=o),(null===(e=this.config.enabledCoachMarkMap)||void 0===e?void 0:e[n.gz.MarketLanguage])&&d.$n&&(this.marketList=d.$n.sort(d.bT)),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",this.backgroundColorChangeHandler),this.collectionInstance=r.W.getInstance(),yield this.registerCallback();const a=yield this.collectionInstance.getAvailableDataAsync(this.config.isInternal,T,this.dataFromIris);this.availableData=a.filter((t=>{var e;return null===(e=this.getCoachMarkConfig(t.coachMarkKey))||void 0===e?void 0:e.enabled})),this.availableData.forEach((t=>{const e=t.coachMarkKey;r.W.getInstance().getCollection().IsTriggered(e)&&this.callback(e,r.W.getInstance().getCollection().getCoachMark(e))})),null===(i=(0,s.Un)())||void 0===i||i.registerSurface(this,this.onPlacementReceived.bind(this))}))))}))}onPlacementReceived(t){var e,i,o,a,s,l,c,h,d,m,u,g,p,f,k,b;const y=t.surfaceModel,C=t.contentModel,w=t.id,P={coachMarkKey:w,placementId:t.id,head:C.title,body:C.description,size:y.size,dismissEvents:n.OD.Outside,coverUrl:null===(e=C.contentImage)||void 0===e?void 0:e.url,darkCoverUrl:null===(i=C.contentImage)||void 0===i?void 0:i.url,confirmButtonLabel:null===(o=C.engageContentAction)||void 0===o?void 0:o.label,showConfirmButton:!!(null===(a=C.engageContentAction)||void 0===a?void 0:a.label),cancelButtonLabel:null===(s=C.dismissContentAction)||void 0===s?void 0:s.label,showCancelButton:!!(null===(l=C.dismissContentAction)||void 0===l?void 0:l.label),autoDismiss:y.dismissAfterSeconds},M=null===(k=null===(p=null===(u=null===(d=null===(c=r.W.getInstance().registrations.register(w,"nurturingFrameWork"))||void 0===c?void 0:c.registerDisplayCallback(null===(h=y.displaySurfaceAction)||void 0===h?void 0:h.actionDelegate))||void 0===d?void 0:d.registerHideCallback(null===(m=y.hideSurfaceAction)||void 0===m?void 0:m.actionDelegate))||void 0===u?void 0:u.registerConfirmCallback(null===(g=C.engageContentAction)||void 0===g?void 0:g.actionDelegate))||void 0===p?void 0:p.registerCancelCallback(null===(f=C.dismissContentAction)||void 0===f?void 0:f.actionDelegate))||void 0===k?void 0:k.registerDismissCallback(null===(b=C.closeContentAction)||void 0===b?void 0:b.actionDelegate);if("string"==typeof y.position)return P.coachmarkFloatingPosition=y.position,void r.W.getInstance().triggerCoachMark(w,{data:P});const L=y.position;let B;P.coachmarkAnchoringPosition=L.anchoringPosition,P.hasPointer=L.hasPointer,P.pointerPosition=L.pointerPosition,B="string"==typeof L.coachmarkAnchor?(0,v.b_)(L.coachmarkAnchor):L.coachmarkAnchor,B&&(null==M||M.registerItemAnchorElement(B),r.W.getInstance().triggerCoachMark(w,{data:P}))}registerCallback(){return(0,o.mG)(this,void 0,void 0,(function*(){this.collectionInstance.registerCallback=this.callback}))}getExperienceType(){return m.x.superCoachMarkWC}shadowDomPopulated(){this.markVisuallyReady(),(0,v.FY)(b._.superCoachMark,this)}disconnectedCallback(){this.removeListeners(),window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",this.backgroundColorChangeHandler)}areCoachmarksEnabled(t){return t.forEach((t=>{var e;if(null===(e=this.config.enabledCoachMarkMap)||void 0===e?void 0:e[t])return!0})),!1}showNext(){for(const[t,e]of this.nextCoachmark.entries()){this.callback(t,e),this.nextCoachmark.delete(t);break}}handleConfirm(){var t,e;(null===(t=this.coachMarkKey)||void 0===t?void 0:t.startsWith("marketLanguage"))&&this.marketSelectorDropdown&&this.marketSelectorDropdown.acceptLanguageChange&&(null===(e=this.marketSelectorDropdown)||void 0===e||e.acceptLanguageChange()),this.confirmCallback&&this.confirmCallback(),this.dialogConfirmButtonUrl&&window.open(this.dialogConfirmButtonUrl,"_blank"),this.hideCoachMark(void 0,!0)}handleCancel(){this.cancelCallback&&this.cancelCallback(),this.areCoachmarksEnabled([n.gz.GamingFeedPromotion,n.gz.LocationAccuracyRevIP])?this.hideCoachMark():this.hideCoachMark(void 0,!0)}handleDismiss(t,e){this.visible&&(this.dismissCallback&&this.dismissCallback(),this.hideCoachMark(t,e))}handleScrollResize(t){this.floatingPosition&&t&&"scroll"==t.type||this.callback(this.coachMarkKey,this.contentItem,this.visible)}updateProps(t,e,i=!1){var a,s;return(0,o.mG)(this,void 0,void 0,(function*(){const i=this.getCoachMarkData(t);if(!i||!(null==e?void 0:e.triggerMessageReceived))return!1;if(this.coachMarkKey===t)return!0;this.contentItem=e,this.dialogTitle=i.head,this.dialogBody=i.body,this.dialogConfirmButtonLabel=i.confirmButtonLabel||"",this.dialogConfirmButtonUrl=i.confirmButtonUrl||"",this.dialogCancelButtonLabel=i.cancelButtonLabel||"",this.dialogDismissButtonLabel=i.dismissButtonLabel||"",this.lightModeCoverUrl=i.coverUrl,this.darkModeCoverUrl=i.darkCoverUrl,this.coverUrl=(0,y.Y)()?this.darkModeCoverUrl:this.lightModeCoverUrl,this.autoDismiss=i.autoDismiss,this.floatingPosition=i.coachmarkFloatingPosition,this.anchorPosition=i.coachmarkAnchoringPosition,this.hasPointer=i.hasPointer,this.pointerPosition=i.pointerPosition,this.coachMarkKey=i.coachMarkKey,this.size=i.size||n.dm.Medium,this.showConfirmButton=i.showConfirmButton||!1,this.showCancelButton=i.showCancelButton||!1,this.showDropDownMenu=i.showDropDownMenu||!1,this.dismissEvents=i.dismissEvents||n.OD.Outside,this.linkText=i.linkText,this.linkUrl=i.linkUrlFormattingFn?i.linkUrlFormattingFn(i.linkUrl):i.linkUrl,this.storePSL=i.storePSL;const o=i.localizationId||i.placementId;if((null===(a=this.config)||void 0===a?void 0:a.localizedStrings)&&o in this.config.localizedStrings&&"marketLanguage"!==this.coachMarkKey){const t=this.config.localizedStrings[o];this.dialogTitle=t&&t.head?t.head:this.dialogTitle,this.dialogBody=t&&t.body?t.body:this.dialogBody,this.dialogConfirmButtonLabel=t&&t.confirmButtonLabel?t.confirmButtonLabel:this.dialogConfirmButtonLabel,this.dialogCancelButtonLabel=t&&t.cancelButtonLabel?t.cancelButtonLabel:this.dialogCancelButtonLabel,this.dialogDismissButtonLabel=t&&t.dismissButtonLabel?t.dismissButtonLabel:this.dialogDismissButtonLabel,this.linkText=t&&t.linkText?t.linkText:this.linkText}(null===(s=this.coachMarkKey)||void 0===s?void 0:s.startsWith("marketLanguage"))&&(this.showDropDownMenu=!0);if(this.coachMarkKey===n.gz.NotificationBellPromotion||this.coachMarkKey===n.gz.NotificationBellPromotionWinHP){const t=yield fetch("https://assets.msn.com/staticsb/statics/latest/icons-wc/icons/notification-bell-wc/NotificationBell.svg");if(t.ok){const e=yield t.text();"string"==typeof this.dialogBody&&(this.dialogBody=p.dy`<div>${p.dy.partial(this.dialogBody.replace("{BellIcon}",`</div>${e}<div>`))}</div>`)}}return this.telemetryContext=new S(this.telemetryObject,o),this.coachmarkHandler=new h(this.size,this.floatingPosition,this.anchorPosition,this.hasPointer,this.pointerPosition,!1),this.dialogStyles=Object.assign(Object.assign({},this.dialogStyles),{width:this.coachmarkHandler.getWidth()}),!0}))}getCoachMarkData(t){var e,i;if(null===(e=this.getCoachMarkConfig(t))||void 0===e?void 0:e.enabled)return(null===(i=this.getCoachMarkConfig(t))||void 0===i?void 0:i.delayTriggerAllowed)?r.W.getInstance().fetchCoachmarkFromEligibleCoachmarks(t):this.availableData.find((e=>e.coachMarkKey===t))}updateStyles(t){var e;if(!(this.coachmarkHandler&&t&&this.rootElement&&this.coachMarkDialog))return!1;const i=t.anchorElement;if(!this.coachmarkHandler.calcPosition(this.rootElement,i,this.coachMarkDialog)){return(null===(e=this.config.enabledCoachMarkMap)||void 0===e?void 0:e[n.gz.GamingFeedPromotion])&&this.coachMarkKey===n.gz.GamingFeedPromotion&&this.coachmarkHandler.anchoringPosition===n.RC.Above?(this.coachmarkHandler.anchoringPosition=n.RC.Below,this.updateStyles(t)):(u.M0.sendClientLogEvent({message:"Coach Mark exceeds boundaries of page",type:"error"}),!1)}return this.dialogStyles=Object.assign(Object.assign({},this.dialogStyles),{left:this.coachmarkHandler.getStartOffset(),top:this.coachmarkHandler.getTopOffset()}),this.pointerStyles={left:this.coachmarkHandler.getStartOffset4Pointer(),top:this.coachmarkHandler.getTopOffset4Pointer()},!0}updateCallbacks(t){t.displayCallback&&(this.displayCallback=t.displayCallback),t.hideCallback&&(this.hideCallback=t.hideCallback),t.confirmCallback&&(this.confirmCallback=t.confirmCallback),t.cancelCallback&&(this.cancelCallback=t.cancelCallback),t.dismissCallback&&(this.dismissCallback=t.dismissCallback)}handleMouseEnter(t){"mouseenter"===(null==t?void 0:t.type)&&u.M0.sendActionEvent(t.target,g.Aw.Hover,g.wu.View)}removeListeners(){switch(window.removeEventListener("resize",this.scrollResizeHandler),window.removeEventListener("scroll",this.scrollResizeHandler),this.dismissEvents){case n.OD.Outside:window.removeEventListener("click",this.handleClick);break;case n.OD.Target:this.targetElement&&this.targetElement.removeEventListener("click",(t=>{this.hideCoachMark(t,!0)}));break;case n.OD.OutsideAndTarget:window.removeEventListener("click",this.handleClick),this.targetElement&&this.targetElement.removeEventListener("click",(t=>{this.hideCoachMark(t,!0)}))}}afterCoachMarkShow(){return(0,o.mG)(this,void 0,void 0,(function*(){this.coachMarkKey&&(this.displayCallback&&this.displayCallback(),r.W.getInstance().setCoachMarkShown(this.coachMarkKey),this.storePSL&&(yield r.W.getInstance().setCoachMarkShownPreferenceSetting(this.coachMarkKey)))}))}getCoachMarkConfig(t){var e;const i=this.collectionInstance.registrations.IsRegisteredByNurturingFramework(t)?n.gz.NurturingPlacementManagerTestKey:t;return null===(e=this.config.enabledCoachMarkMap)||void 0===e?void 0:e[i]}}(0,o.gn)([f.LO],E.prototype,"telemetryContext",void 0),(0,o.gn)([f.LO],E.prototype,"visible",void 0),(0,o.gn)([(0,k.Lj)({attribute:"coachmark-key"})],E.prototype,"coachMarkKey",void 0),(0,o.gn)([f.LO],E.prototype,"dialogStyles",void 0),(0,o.gn)([f.LO],E.prototype,"pointerStyles",void 0),(0,o.gn)([f.LO],E.prototype,"points",void 0),(0,o.gn)([f.LO],E.prototype,"dropShadow",void 0),(0,o.gn)([f.LO],E.prototype,"dialogTitle",void 0),(0,o.gn)([f.LO],E.prototype,"dialogBody",void 0),(0,o.gn)([f.LO],E.prototype,"dialogConfirmButtonLabel",void 0),(0,o.gn)([f.LO],E.prototype,"dialogConfirmButtonUrl",void 0),(0,o.gn)([f.LO],E.prototype,"dialogCancelButtonLabel",void 0),(0,o.gn)([f.LO],E.prototype,"dialogDismissButtonLabel",void 0),(0,o.gn)([f.LO],E.prototype,"coverUrl",void 0),(0,o.gn)([f.LO],E.prototype,"rootElement",void 0),(0,o.gn)([f.LO],E.prototype,"targetElement",void 0),(0,o.gn)([f.LO],E.prototype,"size",void 0),(0,o.gn)([f.LO],E.prototype,"floatingPosition",void 0),(0,o.gn)([f.LO],E.prototype,"hasPointer",void 0),(0,o.gn)([f.LO],E.prototype,"anchorPosition",void 0),(0,o.gn)([f.LO],E.prototype,"pointerPosition",void 0),(0,o.gn)([f.LO],E.prototype,"autoDismiss",void 0),(0,o.gn)([f.LO],E.prototype,"dismissEvents",void 0),(0,o.gn)([f.LO],E.prototype,"showConfirmButton",void 0),(0,o.gn)([f.LO],E.prototype,"showCancelButton",void 0),(0,o.gn)([f.LO],E.prototype,"showDropDownMenu",void 0),(0,o.gn)([f.LO],E.prototype,"displayCallback",void 0),(0,o.gn)([f.LO],E.prototype,"hideCallback",void 0),(0,o.gn)([f.LO],E.prototype,"confirmCallback",void 0),(0,o.gn)([f.LO],E.prototype,"cancelCallback",void 0),(0,o.gn)([f.LO],E.prototype,"dismissCallback",void 0),(0,o.gn)([f.LO],E.prototype,"marketList",void 0),(0,o.gn)([f.LO],E.prototype,"linkText",void 0),(0,o.gn)([f.LO],E.prototype,"linkUrl",void 0),(0,o.gn)([f.LO],E.prototype,"linkUrlFormattingFn",void 0),(0,o.gn)([f.LO],E.prototype,"storePSL",void 0);var z=i(93703),R=i(41472),_=i(545),I=i(28904);const $=p.dy`<div class="market-selector-settings"><div id="dropDownCoachMarkId" class="language-dropdown"><msn-market-selector :id="${t=>t.marketSelectorProps.id}" :onValueChange="${t=>t.marketSelectorProps.onValueChange}" :defaultMarketId="${t=>t.marketSelectorProps.defaultMarketId}" :selectedMarketId="${t=>t.selectedMarketId}" :marketList="${t=>t.marketSelectorProps.marketList}" :label="${t=>t.marketSelectorProps.label}"></msn-market-selector></div></div>`;var U=i(78923);const K=U.i` .market-selector-settings ::part(select){min-width:240px}`;var F,H=i(53076),j=i(82423),N=i(76858),W=i(41691),G=i(38349),V=i(76868);!function(t){t.rtl="rtl",t.ltr="ltr"}(F||(F={}));let Y=class extends I.H{constructor(){super(...arguments),this.configMarkets=[],this.marketSelectorProps={},this.acceptLanguageChange=()=>{var t;this.changedMarket&&(u.M0.addOrUpdateTmplProperty("marketLanguage_changed_market_from",this.previousMarket),u.M0.addOrUpdateTmplProperty("marketLanguage_changed_market_to",this.changedMarket),this.chromiumPageSettingsDataConnector&&(null===(t=W.V.marketUpdated.getActionSender(this.chromiumPageSettingsDataConnector))||void 0===t||t.send(this.changedMarket),(0,G.yV)(V.y.MarketChange)))}}connectedCallback(){const t=Object.create(null,{connectedCallback:{get:()=>super.connectedCallback}});return(0,o.mG)(this,void 0,void 0,(function*(){this.chromiumPageSettingsDataConnector=(0,j.K0)(H.z.ChromiumPageSettings),yield this.instantiateMarketSelectorExperience(),t.connectedCallback.call(this)}))}instantiateMarketSelectorExperience(){return(0,o.mG)(this,void 0,void 0,(function*(){if(this.configMarkets){if(this.marketSelectionOptions=[...this.configMarkets],this.marketSelectorProps.marketList=this.marketSelectionOptions,this.marketSelectorProps.id="marketSelector",!this.chromiumPageSettingsDataConnector)return;const t=yield this.chromiumPageSettingsDataConnector.getPageSettingsStateAsync();if(!t)return;const e=t.market;if(!e||""===e)return;this.previousMarket=e,this.selectedMarketId=e,this.marketSelectorProps.onValueChange=t=>{this.changedMarket=t},yield(0,N.y)()}}))}};(0,o.gn)([k.Lj],Y.prototype,"configMarkets",void 0),(0,o.gn)([f.LO],Y.prototype,"changedMarket",void 0),(0,o.gn)([f.LO],Y.prototype,"marketSelectorProps",void 0),(0,o.gn)([f.LO],Y.prototype,"selectedMarketId",void 0),(0,o.gn)([f.LO],Y.prototype,"previousMarket",void 0),Y=(0,o.gn)([(0,I.M)({name:"market-selector-dropdown",template:$,styles:K})],Y);const q=p.dy`<div class="pointer" style=${t=>`left: ${t.pointerStyles.left}px; top: ${t.pointerStyles.top}px;`}><svg height="16" viewBox="0 0 16 16" width="16"><polygon points=${t=>t.points}></polygon></svg></div>`,Q=p.dy`<div class="dialog-image-container"><img src="${t=>t.coverUrl}" class="dialog-image" role="presentation" alt="" /></div>`,J=p.dy`<div class="dialog-link"><a href="${t=>t.linkUrl}" data-t="${t=>{var e;return null===(e=t.telemetryContext)||void 0===e?void 0:e.linkTelemetryMetaTag}}">${t=>t.linkText}</a></div>`,X=p.dy`<fluent-button class="dismiss-button" aria-label=${t=>t.dialogDismissButtonLabel} tabindex="0" role="presentation" title=${t=>t.dialogDismissButtonLabel} @click=${(t,e)=>t.handleDismiss(e.event,!0)} data-t="${t=>{var e;return null===(e=t.telemetryContext)||void 0===e?void 0:e.dismissButtonTelemetryMetaTag}}">${p.dy.partial(_.Z)}</fluent-button>`,Z=p.dy`<div class="dialog-button-group">${(0,z.g)((t=>t.showConfirmButton),p.dy`<fluent-button aria-label=${t=>t.dialogConfirmButtonLabel} role="button" tabindex="0" title=${t=>t.dialogConfirmButtonLabel} appearance="accent" class="dialog-button confirm-button" data-t="${t=>{var e;return null===(e=t.telemetryContext)||void 0===e?void 0:e.confirmButtonTelemetryMetaTag}}" exportparts="content" @click=${t=>t.handleConfirm()}>${t=>t.dialogConfirmButtonLabel}</fluent-button>`)} ${(0,z.g)((t=>t.showCancelButton),p.dy`<fluent-button aria-label=${t=>t.dialogCancelButtonLabel} role="button" tabindex="0" title=${t=>t.dialogCancelButtonLabel} appearance="outline" class="dialog-button cancel-button" data-t="${t=>{var e;return null===(e=t.telemetryContext)||void 0===e?void 0:e.cancelButtonTelemetryMetaTag}}" @click=${t=>t.handleCancel()}>${t=>t.dialogCancelButtonLabel}</fluent-button>`)}</div>`,tt=p.dy`<div class="drop-down-menu-box"><market-selector-dropdown ${(0,R.i)("marketSelectorDropdown")} :configMarkets="${t=>t.marketList}"></market-selector-dropdown></div>`,et=p.dy`<div class="coach-mark-container ${t=>t.visible?"":"hidden"} id = "superCoachMark" data-t="${t=>{var e;return null===(e=t.telemetryContext)||void 0===e?void 0:e.superCoachMarkContainerTelemetryMetaTag}}">${(0,z.g)((t=>t.hasPointer),q)}<div ${(0,R.i)("coachMarkDialog")} @mouseenter=${(t,e)=>t.handleMouseEnter(e.event)} class="dialog" aria-label=${t=>t.dialogTitle} style=${t=>`left: ${t.dialogStyles.left}px; top: ${t.dialogStyles.top}px; width: ${t.dialogStyles.width}px`}>${(0,z.g)((t=>t.coverUrl),Q)}<div class="title-container"><div class="dialog-title" tabindex="0" role="heading" aria-label=${t=>t.dialogTitle}>${t=>t.dialogTitle}</div>${X}</div><div class="dialog-body" tabindex="0" role="tooltip">${t=>t.dialogBody}</div>${(0,z.g)((t=>t.linkText&&t.linkUrl),J)} ${(0,z.g)((t=>t.showDropDownMenu),tt)} ${(0,z.g)((t=>t.showConfirmButton||t.showCancelButton),Z)}</div></div>`;var it=i(27460),ot=i(35680),at=i(42689),st=i(22674);const nt=U.i` .dismiss-button{right:12px}`,rt=U.i` .dismiss-button{left:12px}`,lt=U.i` .dialog{position:fixed;z-index:999;display:flex;flex-direction:column;border-radius:8px;font-size:14px;box-sizing:border-box;padding:12px;background-color:#FFFFFF;box-shadow:0px 0px 2px 0px #0000001F}.pointer{z-index:1000;position:fixed}.pointer svg{fill:${it.s};display:block}.hidden{visibility:hidden}.dismiss-button{grid-row:1;height:20px;width:20px;min-width:20px;background:none;display:flex;justify-content:center;align-items:center;border:none;cursor:pointer;border-radius:4px;fill:rgba(0,0,0,0.619608)}.dismiss-button:hover{background:${ot.Xi}}.dismiss-button svg{height:12px;width:12px}.dialog-image-container{width:100%;object-fit:cover;overflow:hidden;box-sizing:border-box;aspect-ratio:1.84;border-radius:6px}.dialog-image{width:100%;height:100%}.title-container{display:grid;grid-template-columns:12fr 1fr;margin:12px 0 0 0}.title-container:first-child{margin:0}.dialog-title{grid-row:1;font-weight:600;font-size:14px;line-height:20px}.dialog-body{display:flex;align-items:center;font-size:14px;line-height:20px;margin:2px 0 0 0}.dialog-button-group{display:flex;flex:1;gap:8px;margin:12px 0 0 0;font-weight:600}.dialog-button{flex:1;border-radius:4px}.dialog-button::part(control){width:100%}.dialog-button::part(content){width:100%;overflow:hidden;text-overflow:ellipsis}.confirm-button{background-color:#2169EB}.confirm-button:hover{background-color:var(--accent-fill-hover)}.cancel-button{background-color:#FFFFFF;border-color:#D1D1D1}.cancel-button:hover{border-color:var(--neutral-stroke-hover)}.dialog-link{font-size:12px;line-height:16px;margin:8px 16px 0}.dialog-body svg{margin:0px 6px;fill:${at.C}}.drop-down-menu-box{margin:8px 12px 0}:host([coachmark-key="multiLocationsCarouselV2"]) .dialog{z-index:100}:host([coachmark-key="multiLocationsCarouselV2"]) .pointer{z-index:100}@media (prefers-color-scheme:dark){.dialog{background-color:#404040;box-shadow:0px 0px 2px 0px #0000003D}.pointer svg{fill:#404040}.dismiss-button{fill:#FFFFFF}.confirm-button{background-color:#235CCF}.cancel-button{background-color:#292929;border-color:#666666}}`.withBehaviors(new st.O(nt,rt)),ct={experienceConfigSchema:undefined}},96324:function(t,e,i){i.d(e,{Un:function(){return y},E0:function(){return k},c0:function(){return b}});var o,a,s,n=i(33940),r=i(65453),l=i(58155);!function(t){t.IrisCoachmark="iris-coachmark",t.IrisHorizontalBanner="iris-horizontal-banner",t.AmplifyCoachmark="amplify-coachmark",t.AmplifyHorizontalBanner="amplify-horizontal-banner"}(o||(o={})),function(t){t.LocalStore="local-store",t.PersistentStore="persistent-store"}(a||(a={})),function(t){t.Individual="individual",t.Group="group"}(s||(s={}));var c=i(59294);class h{constructor(t){this._priorityComparator=t,this._placementsArray=[]}enqueuePlacements(t){var e;t&&t.length&&(this._placementsArray.push(...t),this._priorityComparator&&this._placementsArray.sort(),null===(e=this._waitForPlacementSettablePromise)||void 0===e||e.set())}dequeuePlacement(){return(0,n.mG)(this,void 0,void 0,(function*(){this._placementsArray.length||(this._waitForPlacementSettablePromise=new c.o,yield this._waitForPlacementSettablePromise.getResultAsync());const t=this._placementsArray.shift();if(!t)throw new Error("Queue is empty but attempted to return a placement.");return t}))}}var d=i(26415);class m{constructor(){this._placementsSurfaceMap={}}addPlacements(t){t&&t.length&&t.forEach((t=>{const e=t.surfaceModel.surfaceType,i=this._placementsSurfaceMap[e];i?i.push(t):this._placementsSurfaceMap[e]=[t]}))}getPlacementsBySurface(t){const{surfaceType:e,supportedContentTypes:i}=t,o=this._placementsSurfaceMap[e];if(o&&o.length)return o.filter((t=>i.includes(t.contentModel.contentType)))}}class u{constructor(t,e=[]){this._surfacesRegisteredCallback=t,this._expectedSurfaces=e,this._surfaceRegistry={}}addSurface(t,e){t&&e&&(this.addSurfaceToRegistry(t,e),this._expectedSurfaces.length&&(this._expectedSurfaces=this._expectedSurfaces.filter((e=>e!==t.surfaceType)),this._expectedSurfaces.length)||this._surfacesRegisteredCallback([t]))}getSurfaceCallbackForPlacement(t){const e=t.surfaceModel.surfaceType,i=this._surfaceRegistry[e];if(!i)return;return i[t.contentModel.contentType]}addSurfaceToRegistry(t,e){const{surfaceType:i,supportedContentTypes:o}=t;o.forEach((t=>{const o=this._surfaceRegistry[i];o?o[t]=e:this._surfaceRegistry[i]={[t]:e}}))}}var g=i(65135),p=i(4734),f=i(32717);class k{constructor(t,e,i,o){this._placementProviders=t,this._interactionsTracker=e,this._rules=i,this._extensionContext=o,this._placementRegistry=new m,this._placementProcessingQueue=new h(null==o?void 0:o.priorityComparator),this._surfaceRegistry=new u(this.onSurfacesRegistered.bind(this),null==o?void 0:o.expectedSurfaces),this.initializeProviders(),Promise.all([(0,f.eC)(),(0,p.F_)()]).then(this.processPlacements.bind(this))}get Interactions(){return this._interactionsTracker.getPlacementsInteractions()}registerSurface(t,e){const{surfaceType:i,supportedContentTypes:o}=t||{};i&&o.length&&e?this._surfaceRegistry.addSurface(t,e):g.M0.sendAppErrorEvent(Object.assign(Object.assign({},d.hle.PlacementManagerError),{message:"Surface Type, Supported Content Types or Surface Callback are not provided."}))}initializeProviders(){return(0,n.mG)(this,void 0,void 0,(function*(){this._placementProviders.filter((t=>null==t?void 0:t.subscribeForPlacementStream)).forEach((t=>t.subscribeForPlacementStream((t=>this.onPlacementsReceived([t])))));const t=this._placementProviders.filter((t=>null==t?void 0:t.getAvailablePlacements)).map((t=>t.getAvailablePlacements())),e=(yield Promise.all(t)).flat();this.onPlacementsReceived(e)}))}onPlacementsReceived(t){var e,i;(null==t?void 0:t.length)&&(null===(i=null===(e=this._extensionContext)||void 0===e?void 0:e.onPlacementsReceived)||void 0===i||i.call(e,t),t.forEach((t=>{t.reportInteraction(r.p.Served)})),this._placementRegistry.addPlacements(t),this._placementProcessingQueue.enqueuePlacements(t.filter((t=>!!this._surfaceRegistry.getSurfaceCallbackForPlacement(t)))))}onSurfacesRegistered(t){const e=t.flatMap((t=>this._placementRegistry.getPlacementsBySurface(t)||[]));this._placementProcessingQueue.enqueuePlacements(e)}processPlacements(){return(0,n.mG)(this,void 0,void 0,(function*(){for(;;){const t=yield this._placementProcessingQueue.dequeuePlacement();(yield this.evaluatePlacement(t))&&(yield this.sendPlacementToSurface(t))}}))}evaluatePlacement(t){return(0,n.mG)(this,void 0,void 0,(function*(){const e=function(){const t=l.c.getQueryParameterByName("ignoreNurturingPlacementRules",window.location.search);return t?t.split(",").map((t=>t.trim())):[]}(),i=this._interactionsTracker.getPlacementsInteractions();if(!e.includes(s.Individual))for(const e of t.getPlacementRules()){if(!(yield e(t,i)))return!1}if(!e.includes(s.Group)){const e=this._rules[t.group]||[];for(const o of e){if(!(yield o(t,i)))return!1}}if("1"===l.c.getQueryParameterByName("vptest",window.location.search)){if(!function(){const t=l.c.getQueryParameterByName("filterNurturingPlacements",window.location.search);return t?t.split(",").map((t=>t.trim())):[]}().includes(t.id))return!1}return!0}))}sendPlacementToSurface(t){return(0,n.mG)(this,void 0,void 0,(function*(){const e=this._surfaceRegistry.getSurfaceCallbackForPlacement(t);if(!e)return void g.M0.sendAppErrorEvent(Object.assign(Object.assign({},d.hle.PlacementManagerError),{message:"Surface is not registered for this Content Type."}));const i=new c.o,o=new c.o,a=Promise.all([i.getResultAsync(),o.getResultAsync()]);t.onPlacementInteraction=e=>{var a,s;null===(s=null===(a=this._extensionContext)||void 0===a?void 0:a.onPlacementInteraction)||void 0===s||s.call(a,t,e),this._interactionsTracker.logPlacementInteraction(t.id,e),e===r.p.Viewed&&i.set(),e===r.p.Hidden&&o.set()},e(t);const s=t.surfaceModel.dismissAfterSeconds?1e3*t.surfaceModel.dismissAfterSeconds:0;s?yield Promise.race([a,new Promise((t=>setTimeout(t,s)))]):yield a}))}}let v;const b=t=>{v=t},y=()=>v}}]);